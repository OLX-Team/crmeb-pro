(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7291d09f"],{"0530":function(t,e,r){"use strict";var a=r("de7e"),n=r.n(a);n.a},"90e7":function(t,e,r){"use strict";r.d(e,"m",(function(){return n})),r.d(e,"h",(function(){return o})),r.d(e,"i",(function(){return i})),r.d(e,"g",(function(){return s})),r.d(e,"l",(function(){return l})),r.d(e,"c",(function(){return c})),r.d(e,"a",(function(){return d})),r.d(e,"b",(function(){return m})),r.d(e,"f",(function(){return u})),r.d(e,"j",(function(){return f})),r.d(e,"k",(function(){return p})),r.d(e,"d",(function(){return g})),r.d(e,"e",(function(){return h}));var a=r("b6bd");function n(){return Object(a["a"])({url:"system/role",method:"get"})}function o(t){return Object(a["a"])({url:"system/role/".concat(t.id),method:"post",data:t})}function i(t){return Object(a["a"])({url:"system/role/".concat(t,"/edit"),method:"get"})}function s(){return Object(a["a"])({url:"system/menusList",method:"get"})}function l(t){return Object(a["a"])({url:"system/admin",method:"get",params:t})}function c(t,e){return Object(a["a"])({url:"system/admin/set_status/".concat(t,"/").concat(e),method:"put"})}function d(){return Object(a["a"])({url:"system/admin/create",method:"get"})}function m(t){return Object(a["a"])({url:"system/admin/".concat(t,"/edit"),method:"get"})}function u(){return Object(a["a"])({url:"config",method:"get"})}function f(){return Object(a["a"])({url:"system/store/info",method:"get"})}function p(t){return Object(a["a"])({url:"system/store/update",method:"put",data:t})}function g(t){return Object(a["a"])({url:"city",method:"get",params:t})}function h(t){return Object(a["a"])({url:"system/config/edit_basics",method:"get",params:t})}},de7e:function(t,e,r){},ff38:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{staticClass:"ivu-mt acea-row row-center-wrapper",attrs:{bordered:!1,"dis-hover":""}},[r("Form",{ref:"formItem",attrs:{model:t.formItem,"label-width":t.labelWidth,"label-position":t.labelPosition,rules:t.ruleValidate},nativeOn:{submit:function(t){t.preventDefault()}}},[r("Row",{staticStyle:{width:"580px",margin:"0 auto"},attrs:{type:"flex"}},[r("Col",{attrs:{span:"24"}},[r("Col",t._b({},"Col",t.grid,!1),[r("FormItem",{attrs:{label:"门店照片：",prop:"image"}},[r("div",{staticClass:"picBox",on:{click:function(e){return t.modalPicTap("单选")}}},[t.formItem.image?r("div",{staticClass:"pictrue"},[r("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.formItem.image,expression:"formItem.image"}]})]):r("div",{staticClass:"upLoad acea-row row-center-wrapper"},[r("span",{staticClass:"iconfont icontupian"})])])])],1)],1),r("Col",{attrs:{span:"24"}},[r("Col",t._b({},"Col",t.grid,!1),[r("FormItem",{attrs:{label:"门店名称：",prop:"name","label-for":"name"}},[r("Input",{staticClass:"inputW",attrs:{maxlength:"20","show-word-limit":"",placeholder:"请输入门店名称"},model:{value:t.formItem.name,callback:function(e){t.$set(t.formItem,"name",e)},expression:"formItem.name"}})],1)],1)],1),r("Col",{attrs:{span:"24"}},[r("Col",t._b({},"Col",t.grid,!1),[r("FormItem",{attrs:{label:"门店简介：","label-for":"introduction"}},[r("Input",{staticClass:"inputW",attrs:{maxlength:"100","show-word-limit":"",placeholder:"请输入门店简介"},model:{value:t.formItem.introduction,callback:function(e){t.$set(t.formItem,"introduction",e)},expression:"formItem.introduction"}})],1)],1)],1),r("Col",{attrs:{span:"24"}},[r("Col",t._b({},"Col",t.grid,!1),[r("FormItem",{attrs:{label:"门店手机号：","label-for":"phone",prop:"phone"}},[r("Input",{staticClass:"inputW",attrs:{placeholder:"请输入门店手机号"},model:{value:t.formItem.phone,callback:function(e){t.$set(t.formItem,"phone",e)},expression:"formItem.phone"}})],1)],1)],1),r("Col",{attrs:{span:"24"}},[r("Col",t._b({},"Col",t.grid,!1),[r("FormItem",{attrs:{label:"营业状态：","label-for":"is_show",prop:"is_show"}},[r("i-switch",{attrs:{size:"large","false-value":0,"true-value":1},model:{value:t.formItem.is_show,callback:function(e){t.$set(t.formItem,"is_show",e)},expression:"formItem.is_show"}},[r("span",{attrs:{slot:"open","true-value":1},slot:"open"},[t._v("开启")]),r("span",{attrs:{slot:"close","false-value":0},slot:"close"},[t._v("关闭")])])],1)],1)],1),1==t.formItem.is_show?r("Col",{attrs:{span:"24"}},[r("Col",t._b({},"Col",t.grid,!1),[r("FormItem",{attrs:{label:"营业时间：","label-for":"day_time",prop:"day_time"}},[r("TimePicker",{staticClass:"inputW",attrs:{type:"timerange",format:"HH:mm:ss",value:t.formItem.day_time,placement:"bottom-end",placeholder:"请选择营业时间"},on:{"on-change":t.onchangeTime},model:{value:t.formItem.day_time,callback:function(e){t.$set(t.formItem,"day_time",e)},expression:"formItem.day_time"}})],1)],1)],1):t._e(),r("Col",{attrs:{span:"24"}},[r("Col",t._b({},"Col",t.grid,!1),[r("FormItem",{attrs:{label:"到店自提：","label-for":"mention",prop:"mention"}},[r("i-switch",{attrs:{size:"large","false-value":0,"true-value":1},model:{value:t.formItem.is_store,callback:function(e){t.$set(t.formItem,"is_store",e)},expression:"formItem.is_store"}},[r("span",{attrs:{slot:"open","true-value":1},slot:"open"},[t._v("开启")]),r("span",{attrs:{slot:"close","false-value":0},slot:"close"},[t._v("关闭")])])],1)],1)],1),r("Col",{attrs:{span:"24"}},[r("Col",t._b({},"Col",t.grid,!1),[r("FormItem",{attrs:{label:"门店地址：","label-for":"address",prop:"address"}},[r("Cascader",{staticClass:"inputW",attrs:{data:t.addresData,"load-data":t.loadData},on:{"on-change":t.addchack},model:{value:t.formItem.addressSelect,callback:function(e){t.$set(t.formItem,"addressSelect",e)},expression:"formItem.addressSelect"}})],1)],1)],1),r("Col",{attrs:{span:"24"}},[r("Col",t._b({},"Col",t.grid,!1),[r("FormItem",{attrs:{label:"配送范围(半径)：","label-for":"valid_range",prop:"valid_range"}},[r("InputNumber",{attrs:{min:0,step:.001,formatter:function(e){return""+t.formItem.valid_range},parser:function(t){return t.replace("%","")}},model:{value:t.formItem.valid_range,callback:function(e){t.$set(t.formItem,"valid_range",e)},expression:"formItem.valid_range"}}),r("span",{staticStyle:{"margin-left":"10px"}},[t._v("km")])],1)],1)],1),r("Col",{attrs:{span:"24"}},[r("Col",t._b({},"Col",t.grid,!1),[r("FormItem",{attrs:{label:"门店详细地址：","label-for":"detailed_address",prop:"detailed_address"}},[r("Input",{staticClass:"inputW",attrs:{search:"","enter-button":"查找位置",placeholder:"输入地址(包含城市名称,否则会影响搜索精度)"},on:{"on-search":t.onSearch},model:{value:t.formItem.detailed_address,callback:function(e){t.$set(t.formItem,"detailed_address",e)},expression:"formItem.detailed_address"}})],1)],1)],1),t.isApi?r("Col",{attrs:{span:"24"}},[t.mapKey?r("Maps",{ref:"mapChild",staticClass:"map-sty",attrs:{mapKey:t.mapKey,lat:Number(t.formItem.latitude||34.34127),lon:Number(t.formItem.longitude||108.93984),address:t.formItem.detailed_address},on:{getCoordinates:t.getCoordinates}}):t._e()],1):t._e()],1),r("div",{staticClass:"footer acea-row row-center-wrapper"},[r("Button",{staticClass:"ml20",attrs:{type:"primary"},on:{click:function(e){return t.handleSubmit("formItem")}}},[t._v("保存")])],1),t.spinShow?r("Spin",{attrs:{size:"large",fix:""}}):t._e()],1)],1),r("Modal",{attrs:{width:"950px",scrollable:"","footer-hide":"",closable:"",title:"上传门店照片","mask-closable":!1,"z-index":99},model:{value:t.modalPic,callback:function(e){t.modalPic=e},expression:"modalPic"}},[t.modalPic?r("uploadPictures",{attrs:{isChoice:t.isChoice,gridBtn:t.gridBtn,gridPic:t.gridPic},on:{getPic:t.getPic}}):t._e()],1)],1)},n=[],o=r("a34a"),i=r.n(o),s=r("90e7"),l=r("2f62"),c=r("b0e7"),d=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},m=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticStyle:{width:"100%",height:"450px"},attrs:{id:"container"}})])}];function u(t){return new Promise((function(e,r){window.init=function(){e(window.qq)};var a=document.createElement("script");a.type="text/javascript",a.src="https://map.qq.com/api/js?v=2.exp&callback=init&key=".concat(t),a.onerror=r,document.head.appendChild(a)}))}var f={props:{lat:{type:Number,default:34.34127},lon:{type:Number,default:108.93984},mapKey:{tyep:String},address:{tyep:String}},data:function(){return{geocoder:void 0,marker:null,resultDatail:{}}},created:function(){this.initMap()},methods:{initMap:function(){var t=this;u(this.mapKey).then((function(e){var r,a=new e.maps.LatLng(t.lat,t.lon);r=new e.maps.Map(document.getElementById("container"),{zoom:15}),t.geocoder=new e.maps.Geocoder({complete:function(a){r.setCenter(a.detail.location),t.marker=new e.maps.Marker({map:r,position:a.detail.location}),t.resultDatail=a.detail,t.$emit("getCoordinates",a.detail)}}),t.geocoder.getAddress(a),e.maps.event.addListener(r,"click",(function(r){t.marker.setMap(null),t.marker.position={lat:r.latLng.getLat(),lng:r.latLng.getLng()};var a=new e.maps.LatLng(r.latLng.getLat(),r.latLng.getLng());t.geocoder.getAddress(a)}))}))},searchKeyword:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"西安";this.marker.setMap(null),this.geocoder.getLocation(t)}}},p=f,g=r("2877"),h=Object(g["a"])(p,d,m,!1,null,"55512a5f",null),b=h.exports;function v(t,e,r,a,n,o,i){try{var s=t[o](i),l=s.value}catch(c){return void r(c)}s.done?e(l):Promise.resolve(l).then(a,n)}function I(t){return function(){var e=this,r=arguments;return new Promise((function(a,n){var o=t.apply(e,r);function i(t){v(o,a,n,i,s,"next",t)}function s(t){v(o,a,n,i,s,"throw",t)}i(void 0)}))}}function y(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,a)}return r}function _(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?y(r,!0).forEach((function(e){w(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):y(r).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function w(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var C={name:"systemStore",components:{uploadPictures:c["a"],Maps:b},props:{},data:function(){var t=this,e=function(t,e,r){if(!e)return r(new Error("请填写手机号"));/^1[3456789]\d{9}$/.test(e)?r():r(new Error("手机号格式不正确!"))},r=function(e,r,a){t.formItem.image?a():a(new Error("请上传门店照片"))};return{formItem:{image:"",name:"",introduction:"",phone:"",is_show:!0,day_time:[],is_store:!0,address:"",detailed_address:"",latitude:"",longitude:"",province:0,city:0,area:0,street:0,addressSelect:[],valid_range:0},spinShow:!1,addresData:[],ruleValidate:{name:[{required:!0,message:"请输入门店名称",trigger:"blur"}],phone:[{required:!0,validator:e,trigger:"blur"}],detailed_address:[{required:!0,message:"请输入详细地址",trigger:"blur"}],image:[{required:!0,validator:r,trigger:"change"}],day_time:[{required:!0,type:"array",message:"请选择营业时间",trigger:"change"},{validator:function(t,e,r,a,n){""===e[0]&&r("请选择营业时间"),r()}}]},mapKey:"",grid:{xl:20,lg:20,md:20,sm:24,xs:24},gridPic:{xl:6,lg:8,md:12,sm:12,xs:12},gridBtn:{xl:4,lg:8,md:8,sm:8,xs:8},modalPic:!1,isChoice:"单选",pid:0,isApi:0}},created:function(){this.getKey(),this.getInfo();var t={pid:0};this.cityInfo(t)},computed:_({},Object(l["e"])("store/layout",["isMobile"]),{labelWidth:function(){return this.isMobile?void 0:120},labelPosition:function(){return this.isMobile?"top":"right"}}),mounted:function(){},methods:{addchack:function(t,e){var r=this;t.forEach((function(t,e){0==e?r.formItem.province=t:1==e?r.formItem.city=t:2==e?r.formItem.area=t:r.formItem.street=t})),this.formItem.address=e.map((function(t){return t.label})).join("/")},cityInfo:function(t){var e=this;Object(s["d"])(t).then((function(t){e.addresData=t.data}))},loadData:function(t,e){t.loading=!0,Object(s["d"])({pid:t.value}).then((function(r){t.children=r.data,t.loading=!1,e()}))},getCoordinates:function(t){if(this.isApi){this.formItem.latitude=t.location.lat||34.34127,this.formItem.longitude=t.location.lng||108.93984;var e=t.addressComponents;-1==this.formItem.detailed_address.indexOf(e.street)&&(this.formItem.detailed_address=t.address+(e.town?e.town:""))}},onSearch:function(){this.$refs.mapChild.searchKeyword(this.formItem.detailed_address)},getKey:function(){var t=this;Object(s["f"])().then((function(e){t.mapKey=e.data.tengxun_map_key})).catch((function(e){t.$Message.error(e.msg)}))},getInfo:function(){var t=this,e=this;e.spinShow=!0,Object(s["j"])().then((function(r){t.isApi=1;var a=[];t.formItem=r.data,r.data.province&&a.push(r.data.province),r.data.city&&a.push(r.data.city),r.data.area&&a.push(r.data.area),r.data.street&&a.push(r.data.street),t.formItem.addressSelect=a,t.$set(t.formItem,"valid_range",t.formItem.valid_range/1e3),e.spinShow=!1})).catch((function(t){e.spinShow=!1,e.$Message.error(t.msg)}))},modalPicTap:function(){this.modalPic=!0},getPic:function(t){this.formItem.image=t.att_dir,this.modalPic=!1},onchangeTime:function(t){this.formItem.day_time=t},handleSubmit:function(t){var e=this;this.$refs[t].validate((function(t){if(t){if(""==e.formItem.day_time[0]&&(e.formItem.day_time=["00:00:00","23:59:59"]),""==e.formItem.valid_range||e.formItem.valid_range<0)return e.$Message.error("请输入有效的门店范围");Object(s["k"])(e.formItem).then(function(){var t=I(i.a.mark((function t(r){return i.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$Message.success(r.msg);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.$Message.error(t.msg)}))}else e.$Message.error("请完善信息")}))}}},O=C,j=(r("0530"),Object(g["a"])(O,a,n,!1,null,"0260908e",null));e["default"]=j.exports}}]);