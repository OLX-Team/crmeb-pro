(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3ddb7f5e"],{"0b65":function(e,t,r){"use strict";t["a"]={shortcuts:[{text:"今天",value:function(){var e=new Date,t=new Date;return t.setTime(new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate())),[t,e]}},{text:"昨天",value:function(){var e=new Date,t=new Date;return t.setTime(t.setTime(new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()-1))),e.setTime(e.setTime(new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()-1))),[t,e]}},{text:"最近7天",value:function(){var e=new Date,t=new Date;return t.setTime(t.setTime(new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()-6))),[t,e]}},{text:"最近30天",value:function(){var e=new Date,t=new Date;return t.setTime(t.setTime(new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()-29))),[t,e]}},{text:"本月",value:function(){var e=new Date,t=new Date;return t.setTime(t.setTime(new Date((new Date).getFullYear(),(new Date).getMonth(),1))),[t,e]}},{text:"本年",value:function(){var e=new Date,t=new Date;return t.setTime(t.setTime(new Date((new Date).getFullYear(),0,1))),[t,e]}}]}},"0fc4":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"c",(function(){return i})),r.d(t,"b",(function(){return o}));var a=r("b6bd");function n(){return Object(a["a"])({url:"erp/config",method:"get"})}function i(e){return Object(a["a"])({url:"store/erp/shop",method:"get",params:e})}function o(e){return Object(a["a"])({url:"product/import_erp_product",method:"post",data:e})}},1997:function(e,t,r){"use strict";var a=r("a645"),n=r.n(a);n.a},"31b4":function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.FromData?r("div",[r("Modal",{class:e.userEdit?"userEdit":"",attrs:{scrollable:"","footer-hide":"",closable:"",title:e.FromData.title,width:"700"},on:{"on-cancel":e.cancel},model:{value:e.modals,callback:function(t){e.modals=t},expression:"modals"}},[["/marketing/coupon/save.html"===e.FromData.action?r("div",{staticClass:"radio acea-row row-middle"},[r("div",{staticClass:"name ivu-form-item-content"},[e._v("优惠券类型")]),r("Radio-group",{on:{"on-change":e.couponsType},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},[r("Radio",{attrs:{label:0}},[e._v("通用券")]),r("Radio",{attrs:{label:1}},[e._v("品类券")]),r("Radio",{attrs:{label:2}},[e._v("商品券")])],1)],1):e._e()],r("form-create",{ref:"fc",staticClass:"formBox",attrs:{option:e.config,rule:Array.from(e.FromData.rules),handleIcon:"false"},on:{"on-submit":e.onSubmit}})],2)],1):e._e()},n=[],i=r("9860"),o=r.n(i),s=r("b6bd"),c=r("2f62");function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(r,!0).forEach((function(t){u(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var f={name:"edit",components:{formCreate:o.a.$form()},computed:l({},Object(c["e"])("admin/userLevel",["taskId","levelId"])),props:{FromData:{type:Object,default:null},userEdit:{type:Number,default:0}},data:function(){return{modals:!1,type:0,config:{global:{upload:{props:{onSuccess:function(e,t){200===e.status?t.url=e.data.src:this.Message.error(e.msg)}}}}},isDisable:!1}},methods:{couponsType:function(){this.$parent.addType(this.type)},onSubmit:function(e){var t=this;if(setTimeout((function(){t.isDisable=!1}),1e3),!this.isDisable){this.isDisable=!0;var r={};r=e,Object(s["a"])({url:this.FromData.action,method:this.FromData.method,data:r}).then((function(e){t.$parent.getList(),t.$Message.success(e.msg),t.modals=!1,setTimeout((function(){t.$emit("submitFail")}),1e3)})).catch((function(e){t.$Message.error(e.msg)}))}},cancel:function(){this.type=0}}},m=f,p=(r("8b61"),r("2877")),h=Object(p["a"])(m,a,n,!1,null,"80656ec0",null);t["a"]=h.exports},3353:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("Card",{staticClass:"ivu-mt",attrs:{bordered:!1,"dis-hover":"",padding:0}},[r("div",{staticClass:"new_card_pd"},[r("Form",{ref:"pagination",attrs:{inline:"",model:e.pagination,"label-width":e.labelWidth,"label-position":e.labelPosition},nativeOn:{submit:function(e){e.preventDefault()}}},[r("FormItem",{attrs:{label:"订单状态："}},[r("Select",{staticStyle:{width:"250px"},model:{value:e.pagination.refund_type,callback:function(t){e.$set(e.pagination,"refund_type",t)},expression:"pagination.refund_type"}},e._l(e.num,(function(t,a){return r("Option",{key:a,attrs:{value:a}},[e._v(e._s(t.name))])})),1)],1),r("FormItem",{attrs:{label:"退款时间："}},[r("DatePicker",{staticStyle:{width:"250px"},attrs:{editable:!1,value:e.timeVal,format:"yyyy/MM/dd",type:"daterange",placement:"bottom-start",placeholder:"自定义时间",options:e.options},on:{"on-change":e.onchangeTime}})],1),r("FormItem",{attrs:{label:"订单号：","label-for":"title"}},[r("Input",{staticStyle:{width:"250px","margin-right":"14px"},attrs:{placeholder:"请输入订单号"},model:{value:e.pagination.order_id,callback:function(t){e.$set(e.pagination,"order_id",t)},expression:"pagination.order_id"}}),r("Button",{attrs:{type:"primary"},on:{click:function(t){return e.orderSearch()}}},[e._v("查询")])],1)],1)],1)]),r("Card",{staticClass:"ivu-mt",attrs:{bordered:!1,"dis-hover":""}},[r("Table",{ref:"table",attrs:{columns:e.thead,data:e.tbody,loading:e.loading,"highlight-row":"","no-userFrom-text":"暂无数据","no-filtered-userFrom-text":"暂无筛选结果"},scopedSlots:e._u([{key:"order_id",fn:function(t){var a=t.row;return[r("span",{staticStyle:{display:"block"},domProps:{textContent:e._s(a.order_id)}}),r("span",{directives:[{name:"show",rawName:"v-show",value:1===a.is_del&&null==a.delete_time,expression:"row.is_del === 1 && row.delete_time == null"}],staticStyle:{color:"#ed4014",display:"block"}},[e._v("用户已删除")])]}},{key:"nickname",fn:function(t){var a=t.row;return[r("div",[e._v(e._s(a.nickname)),null!=a.delete_time?r("span",{staticStyle:{color:"#ed4014"}},[e._v(" (已注销)")]):e._e()])]}},{key:"user",fn:function(t){var a=t.row;return[r("div",[e._v("用户名："+e._s(a.nickname))]),r("div",[e._v("用户ID："+e._s(a.uid))])]}},{key:"refund_type",fn:function(t){var a=t.row;return[1==a.refund_type?r("Tag",{attrs:{color:"blue",size:"medium"}},[e._v("仅退款")]):e._e(),2==a.refund_type?r("Tag",{attrs:{color:"blue",size:"medium"}},[e._v("退货退款")]):e._e(),3==a.refund_type?r("Tag",{attrs:{color:"red",size:"medium"}},[e._v("拒绝退款")]):e._e(),4==a.refund_type?r("Tag",{attrs:{color:"blue",size:"medium"}},[e._v("商品待退货")]):e._e(),5==a.refund_type?r("Tag",{attrs:{color:"blue",size:"medium"}},[e._v("退货待收货")]):e._e(),6==a.refund_type?r("Tag",{attrs:{color:"green",size:"medium"}},[e._v("已退款")]):e._e()]}},{key:"info",fn:function(t){var a=t.row;return[r("Tooltip",{attrs:{theme:"dark","max-width":"300",delay:600}},[e._l(a._info,(function(t,a){return r("div",{key:a,staticClass:"tabBox"},[r("div",{directives:[{name:"viewer",rawName:"v-viewer"}],staticClass:"tabBox_img"},[r("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.cart_info.productInfo.attrInfo?t.cart_info.productInfo.attrInfo.image:t.cart_info.productInfo.image,expression:"\n                  val.cart_info.productInfo.attrInfo\n                    ? val.cart_info.productInfo.attrInfo.image\n                    : val.cart_info.productInfo.image\n                "}]})]),r("span",{staticClass:"tabBox_tit line1"},[t.cart_info.is_gift?r("span",{staticClass:"font-color-red"},[e._v("赠品")]):e._e(),e._v("\n              "+e._s(t.cart_info.productInfo.store_name+" | ")+"\n              "+e._s(t.cart_info.productInfo.attrInfo?t.cart_info.productInfo.attrInfo.suk:"")+"\n            ")])])})),r("div",{attrs:{slot:"content"},slot:"content"},e._l(a._info,(function(t,a){return r("div",{key:a},[t.cart_info.is_gift?r("p",{staticClass:"font-color-red"},[e._v("赠品")]):e._e(),r("p",[e._v(e._s(t.cart_info.productInfo.store_name))]),r("p",[e._v(" "+e._s(t.cart_info.productInfo.attrInfo?t.cart_info.productInfo.attrInfo.suk:""))]),r("p",{staticClass:"tabBox_pice"},[e._v(e._s("￥"+t.cart_info.truePrice+" x "+t.cart_info.cart_num))])])})),0)],2)]}},{key:"statusName",fn:function(t){var a=t.row;return[r("Tooltip",{attrs:{theme:"dark","max-width":"300",delay:600}},[r("div",{staticClass:"pt5",domProps:{innerHTML:e._s(a.refund_reason)}}),r("div",{attrs:{slot:"content"},slot:"content"},[r("div",{staticClass:"pt5"},[e._v("退款原因："+e._s(a.refund_explain))]),a.refund_goods_explain?r("div",{staticClass:"pt5"},[e._v("退货原因："+e._s(a.refund_goods_explain))]):e._e()])]),a.refund_img?r("div",{staticClass:"pictrue-box"},e._l(a.refund_img||[],(function(e,t){return r("div",{directives:[{name:"viewer",rawName:"v-viewer"}],key:t},[r("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e,expression:"item"}],staticClass:"pictrue mr10",attrs:{src:e}})])})),0):e._e()]}},{key:"action",fn:function(t){var a=t.row;return[r("a",{directives:[{name:"show",rawName:"v-show",value:[1,2,5].includes(a.refund_type)&&(parseFloat(a.pay_price)>parseFloat(a.refunded_price)||0==a.pay_price),expression:"\n              [1, 2, 5].includes(row.refund_type) &&\n              (parseFloat(row.pay_price) > parseFloat(row.refunded_price) ||\n                row.pay_price == 0)\n            "}],attrs:{disabled:e.openErp},on:{click:function(t){return e.changeMenu(a,"5")}}},[e._v(e._s(2==a.refund_type?"同意退货":"立即退款"))]),r("Divider",{directives:[{name:"show",rawName:"v-show",value:[1,2,5].includes(a.refund_type)&&(parseFloat(a.pay_price)>parseFloat(a.refunded_price)||0==a.pay_price),expression:"\n              [1, 2, 5].includes(row.refund_type) &&\n              (parseFloat(row.pay_price) > parseFloat(row.refunded_price) ||\n                row.pay_price == 0)\n            "}],attrs:{type:"vertical"}}),r("a",{on:{click:function(t){return e.changeMenu(a,"2")}}},[e._v("订单详情")])]}}])}),r("div",{staticClass:"acea-row row-right page"},[r("Page",{attrs:{total:e.total,current:e.pagination.page,"show-elevator":"","show-total":"","page-size":e.pagination.limit},on:{"on-change":e.pageChange}})],1)],1),r("edit-from",{ref:"edits",attrs:{FromData:e.FromData},on:{submitFail:e.submitFail}}),r("details-from",{ref:"detailss",attrs:{orderDatalist:e.orderDatalist,orderId:e.orderId,rowActive:e.rowActive,openErp:e.openErp}}),r("order-remark",{ref:"remarks",attrs:{remarkType:"refund",orderId:e.orderId},on:{submitFail:e.submitFail}}),r("order-record",{ref:"record"})],1)},n=[],i=r("a34a"),o=r.n(i),s=r("2f62"),c=r("f8b7"),d=r("0fc4"),l=r("31b4"),u=r("fc48"),f=r("61f8"),m=r("417c"),p=r("0b65");function h(e,t,r,a,n,i,o){try{var s=e[i](o),c=s.value}catch(d){return void r(d)}s.done?t(c):Promise.resolve(c).then(a,n)}function g(e){return function(){var t=this,r=arguments;return new Promise((function(a,n){var i=e.apply(t,r);function o(e){h(i,a,n,o,s,"next",e)}function s(e){h(i,a,n,o,s,"throw",e)}o(void 0)}))}}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function _(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(r,!0).forEach((function(t){b(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function b(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var w={components:{editFrom:l["a"],detailsFrom:u["a"],orderRemark:f["a"],orderRecord:m["a"]},data:function(){return{openErp:!1,thead:[{title:"订单号",align:"center",slot:"order_id",minWidth:150},{title:"用户信息",slot:"nickname",minWidth:130},{title:"商品信息",slot:"info",minWidth:300},{title:"实际支付",key:"pay_price",minWidth:70},{title:"发起退款时间",key:"add_time",minWidth:100},{title:"退款状态",slot:"refund_type",minWidth:100},{title:"退款信息",slot:"statusName",minWidth:100},{title:"售后备注",key:"remark",minWidth:80},{title:"操作",slot:"action",fixed:"right",minWidth:150,align:"center"}],tbody:[],num:[],orderDatalist:null,loading:!1,FromData:null,total:0,orderId:0,animal:1,pagination:{page:1,limit:15,order_id:"",time:"",refund_type:0},options:p["a"],timeVal:[],modal:!1,qrcode:null,name:"",spin:!1,rowActive:{}}},computed:_({},Object(s["e"])("order",["orderChartType"]),{labelWidth:function(){return this.isMobile?void 0:96},labelPosition:function(){return this.isMobile?"top":"right"}}),created:function(){this.getErpConfig(),this.getOrderList()},methods:{getErpConfig:function(){var e=this;Object(d["a"])().then((function(t){e.openErp=t.data.open_erp})).catch((function(t){e.$Message.error(t.msg)}))},onchangeCode:function(e){this.animal=e,this.qrcodeShow()},onchangeTime:function(e){this.pagination.page=1,this.timeVal=e,this.pagination.time=this.timeVal[0]?this.timeVal.join("-"):""},getData:function(e,t){var r=this;Object(c["m"])(e).then(function(){var e=g(o.a.mark((function e(a){return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t||(r.$refs.detailss.modals=!0),r.$refs.detailss.activeName="detail",r.orderDatalist=a.data;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){r.$Message.error(e.msg)}))},changeMenu:function(e,t){var r=this;switch(this.orderId=e.id,t){case"1":this.delfromData={title:"修改立即支付",url:"/order/pay_offline/".concat(e.id),method:"post",ids:""},this.$modalSure(this.delfromData).then((function(e){r.$Message.success(e.msg),r.getOrderList()})).catch((function(e){console.log(e),r.$Message.error(e.msg)}));break;case"2":this.rowActive=e,this.getData(e.id);break;case"3":this.$refs.record.modals=!0,this.$refs.record.getList(e.store_order_id);break;case"4":this.$refs.remarks.modals=!0,this.$refs.remarks.formValidate.remark=e.remark;break;case"5":this.getRefundData(e.id,e.refund_type);break;case"6":this.getRefundIntegral(e.id);break;case"7":this.getNoRefundData(e.id);break;case"8":this.delfromData={title:"修改确认收货",url:"/order/take/".concat(e.id),method:"put",ids:""},this.$modalSure(this.delfromData).then((function(e){r.$Message.success(e.msg),r.getOrderList()})).catch((function(e){r.$Message.error(e.msg)}));break;case"10":this.delfromData={title:"立即打印订单",info:"您确认打印此订单吗?",url:"/order/print/".concat(e.id),method:"get",ids:""},this.$modalSure(this.delfromData).then((function(e){r.$Message.success(e.msg),r.$emit("changeGetTabs"),r.getOrderList()})).catch((function(e){console.log(e),r.$Message.error(e.msg)}));break;case"11":this.delfromData={title:"立即打印电子面单",info:"您确认打印此电子面单吗?",url:"/order/order_dump/".concat(e.id),method:"get",ids:""},this.$modalSure(this.delfromData).then((function(e){r.$Message.success(e.msg),r.getOrderList()})).catch((function(e){r.$Message.error(e.msg)}));break;default:this.delfromData={title:"删除订单",url:"/order/del/".concat(e.id),method:"DELETE",ids:""},this.delOrder(e,this.delfromData)}},getRefundData:function(e,t){var r=this;2==t?(this.delfromData={title:"是否立即退货",url:"/refund/agree/".concat(e),method:"get"},this.$modalSure(this.delfromData).then((function(e){r.$Message.success(e.msg),r.getOrderList(),r.getData(r.orderId,1)})).catch((function(e){r.$Message.error(e.msg)}))):this.$modalForm(Object(c["o"])(e)).then((function(){r.getOrderList(),r.getData(r.orderId,1),r.$emit("changeGetTabs")}))},getRefundIntegral:function(e){var t=this;Object(c["N"])(e).then(function(){var e=g(o.a.mark((function e(r){return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.FromData=r.data,t.$refs.edits.modals=!0;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.$Message.error(e.msg)}))},delOrder:function(e,t){var r=this;if(1===e.is_del)this.$modalSure(t).then((function(e){r.$Message.success(e.msg),r.getOrderList()})).catch((function(e){r.$Message.error(e.msg)}));else{var a="错误！",n="<p>您选择的的订单存在用户未删除的订单，无法删除用户未删除的订单！</p>";this.$Modal.error({title:a,content:n})}},submitFail:function(){this.getOrderList(),this.getData(this.orderId,1)},selectChange2:function(e){this.pagination.page=1,this.pagination.refund_type=e,this.getOrderList(e)},getNoRefundData:function(e){var t=this;this.$modalForm(Object(c["p"])(e)).then((function(){t.getOrderList(),t.getData(t.orderId),t.$emit("changeGetTabs")}))},getOrderList:function(){var e=this;this.loading=!0,Object(c["C"])(this.pagination).then((function(t){e.loading=!1;var r=t.data,a=r.count,n=r.list,i=r.num;e.total=a,e.tbody=n,e.num=i,n.forEach((function(t){t.id==e.orderId&&(e.rowActive=t)}))})).catch((function(t){e.loading=!1,e.$Message.error(t.msg)}))},pageChange:function(e){this.pagination.page=e,this.getOrderList()},nameSearch:function(){this.pagination.page=1,this.getOrderList()},orderSearch:function(){this.pagination.page=1,this.getOrderList()},delivery:function(e){var t=this;Object(c["g"])(e.id).then(function(){var e=g(o.a.mark((function e(r){return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.FromData=r.data,t.$refs.edits.modals=!0;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.$Message.error(e.msg)}))}}},y=w,D=(r("1997"),r("2877")),O=Object(D["a"])(y,a,n,!1,null,"32eda7e2",null);t["default"]=O.exports},"8b61":function(e,t,r){"use strict";var a=r("a29b"),n=r.n(a);n.a},a29b:function(e,t,r){},a645:function(e,t,r){}}]);