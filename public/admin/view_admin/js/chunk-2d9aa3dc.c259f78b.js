(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d9aa3dc"],{"011a":function(t,e,s){t.exports=s.p+"view_admin/img/no_chat.b9c3e583.png"},"060a":function(t,e,s){t.exports=s.p+"view_admin/img/no_tk.401d40f4.png"},"0e03":function(t,e,s){},"16b0":function(t,e,s){t.exports=s.p+"view_admin/media/notice.51a07ae7.wav"},2195:function(t,e,s){"use strict";var i=s("a407"),a=s.n(i);a.a},"37d1":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"kefu-layouts"},[s("div",{staticClass:"content-wrapper"},[s("baseHeader",{attrs:{kefuInfo:t.kefuInfo,online:t.online},on:{setOnline:t.setOnline,search:t.bindSearch}}),s("div",{staticClass:"container"},[s("chatList",{attrs:{userOnline:t.userOnline,newRecored:t.newRecored,searchData:t.searchData,isShow:t.isShow},on:{setDataId:t.setDataId,changeType:t.changeType,changeLen:t.changeLen}}),s("div",{staticClass:"chat-content"},[s("div",{staticClass:"chat-body"},[s("happy-scroll",{attrs:{resize:"","hide-horizontal":"","scroll-top":t.scrollTop},on:{"vertical-start":t.scrollHandler}},[s("div",{ref:"scrollBox",staticStyle:{width:"600px",padding:"20px","margin-bottom":"20px"},attrs:{id:"chat_scroll"}},[s("Spin",{directives:[{name:"show",rawName:"v-show",value:t.isLoad,expression:"isLoad"}]},[s("Icon",{staticClass:"demo-spin-icon-load",attrs:{type:"ios-loading",size:"18"}}),s("div",[t._v("Loading")])],1),t._l(t.records,(function(e,i){return s("div",{key:i,staticClass:"chat-item",class:[{"right-box":e.uid==t.kefuInfo.uid},{gary:5==e.msn_type}],attrs:{id:"chat_"+e.id}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"item.show"}],staticClass:"time"},[t._v(t._s(e.time))]),s("div",{staticClass:"flex-box"},[s("div",{staticClass:"avatar"},[s("img",{attrs:{src:e.avatar,alt:""}})]),s("div",{staticClass:"msg-wrapper"},[e.msn_type<=2?[s("div",{staticClass:"txt-wrapper pad16",domProps:{innerHTML:t._s(e.msn)}})]:t._e(),3==e.msn_type?[s("div",{directives:[{name:"viewer",rawName:"v-viewer"}],staticClass:"img-wraper"},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.msn,expression:"item.msn"}],attrs:{alt:""}})])]:t._e(),5==e.msn_type?[s("div",{staticClass:"order-wrapper pad16"},[s("div",{staticClass:"img-box"},[s("img",{attrs:{src:e.productInfo.image,alt:""}})]),s("div",{staticClass:"order-info"},[s("div",{staticClass:"name line1"},[t._v("\n                              "+t._s(e.productInfo.store_name)+"\n                            ")]),s("div",{staticClass:"sku"},[t._v("\n                              库存："+t._s(e.productInfo.stock)+" 销量："+t._s(e.productInfo.sales)+"\n                            ")]),s("div",{staticClass:"price-box"},[s("div",{staticClass:"num"},[t._v("\n                                ¥ "+t._s(e.productInfo.price)+"\n                              ")]),s("a",{staticClass:"more",attrs:{herf:"javascript:;"},on:{click:function(s){return s.stopPropagation(),t.lookGoods(e)}}},[t._v("查看商品 >")])])])])]:t._e(),6!=e.msn_type&&7!=e.msn_type||!(e.orderInfo.length>0||e.orderInfo.id)?t._e():[s("div",{staticClass:"order-wrapper pad16"},[s("div",{staticClass:"img-box"},[s("img",{attrs:{src:e.orderInfo.cartInfo[0].productInfo.image,alt:""}})]),s("div",{staticClass:"order-info"},[s("div",{staticClass:"name line1"},[t._v("\n                              "+t._s(e.orderInfo.order_id)+"\n                            ")]),s("div",{staticClass:"sku"},[t._v("\n                              商品数量："+t._s(e.orderInfo.total_num)+"\n                            ")]),s("div",{staticClass:"price-box"},[s("div",{staticClass:"num"},[t._v("\n                                ¥ "+t._s(e.orderInfo.pay_price)+"\n                              ")]),s("a",{staticClass:"more",attrs:{href:"javascript:;"},on:{click:function(s){return s.stopPropagation(),t.lookOrder(e)}}},[t._v("查看订单 >")])])])])]],2)])])}))],2)])],1),s("div",{staticClass:"chat-textarea"},[s("div",{staticClass:"chat-btn-wrapper"},[s("div",{staticClass:"left-wrapper"},[s("div",{staticClass:"icon-item",on:{click:function(e){e.stopPropagation(),t.isEmoji=!t.isEmoji}}},[s("span",{staticClass:"iconfont iconbiaoqing1"})]),s("div",{staticClass:"icon-item"},[s("Upload",{attrs:{"show-upload-list":!1,headers:t.header,data:t.uploadData,"before-upload":t.beforeUpload,"on-success":t.handleSuccess,format:["jpg","jpeg","png","gif"],"on-format-error":t.handleFormatError,action:t.upload}},[s("span",{staticClass:"iconfont icontupian1"})])],1),s("div",{staticClass:"icon-item",on:{click:function(e){e.stopPropagation(),t.isMsg=!0}}},[s("span",{staticClass:"iconfont iconliaotian"})])]),s("div",{staticClass:"right-wrapper"},[s("div",{staticClass:"icon-item",on:{click:function(e){e.stopPropagation(),t.isTransfer=!t.isTransfer}}},[s("span",{staticClass:"iconfont iconzhuanjie"}),s("span",[t._v("转接")])]),t.isTransfer?s("div",{staticClass:"transfer-box"},[s("transfer",{attrs:{userUid:t.userActive.to_uid},on:{close:t.msgClose,transferPeople:t.transferPeople}})],1):t._e(),t.isTransfer?s("div",{staticClass:"transfer-bg",on:{click:function(e){e.stopPropagation(),t.isTransfer=!1}}}):t._e()]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isEmoji,expression:"isEmoji"}],staticClass:"emoji-box"},t._l(t.emojiList,(function(e,i){return s("div",{key:i,staticClass:"emoji-item"},[s("i",{staticClass:"em",class:e,on:{click:function(s){return s.stopPropagation(),t.select(e)}}})])})),0)]),t.touristLen?s("div",{staticClass:"textarea-box",staticStyle:{position:"relative"}},[s("Input",{directives:[{name:"paste",rawName:"v-paste",value:t.handleParse,expression:"handleParse"}],ref:"textBox",staticStyle:{"font-size":"14px"},attrs:{type:"textarea",rows:4,placeholder:"请输入文字内容"},on:{"on-enter":t.bindEnter},nativeOn:{keydown:function(e){return t.listen(e)}},model:{value:t.chatCon,callback:function(e){t.chatCon=e},expression:"chatCon"}}),s("div",{staticClass:"send-btn"},[s("Button",{staticClass:"btns",attrs:{type:"primary",disabled:t.disabled},on:{click:function(e){return e.stopPropagation(),t.sendText(e)}}},[t._v("发送")])],1)],1):t._e()])]),s("div",[s("rightMenu",{attrs:{isTourist:t.tourist,uid:t.userActive.to_uid,exportOpen:t.kefuInfo.config_export_open,webType:t.userActive.type},on:{bindPush:t.bindPush}})],1)],1),s("Modal",{staticClass:"none-radius isMsgbox",attrs:{mask:!0,width:"600","mask-closable":!1,"footer-hide":!0},model:{value:t.isMsg,callback:function(e){t.isMsg=e},expression:"isMsg"}},[t.isMsg?s("msgWindow",{on:{close:t.msgClose,activeTxt:t.activeTxt}}):t._e()],1),t.isProductBox?s("div",[s("div",{staticClass:"bg",on:{click:function(e){e.stopPropagation(),t.isProductBox=!1}}}),s("goodsDetail",{attrs:{goodsId:t.goodsId}})],1):t._e(),t.isOrder?s("div",[s("Modal",{staticClass:"none-radius",attrs:{title:"订单信息",width:"700","footer-hide":!0,mask:!0},model:{value:t.isOrder,callback:function(e){t.isOrder=e},expression:"isOrder"}},[s("orderDetail",{attrs:{orderId:t.orderId,isReturen:t.isReturen}})],1)],1):t._e()],1)])},a=[],n=s("d708"),r=s("6db4"),o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"base-header"},[s("div",{staticClass:"left-wrapper"},[s("Input",{staticClass:"search_box",attrs:{prefix:"ios-search",placeholder:"搜索用户名称"},on:{"on-enter":t.bindSearch,"on-change":t.inputChange}}),s("div",{staticClass:"user_info"},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.kefuInfo.avatar,expression:"kefuInfo.avatar"}],attrs:{alt:""}}),s("span",[t._v(t._s(t.kefuInfo.nickname))]),s("div",{staticClass:"status-box"},[s("div",{staticClass:"status",class:t.online?"on":"off",on:{click:function(e){return e.stopPropagation(),t.setOnline(e)}}},[s("span",{staticClass:"dot"}),t._v("\n                    "+t._s(t.online?"在线":"下线")+"\n                ")]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isOnline,expression:"isOnline"}],staticClass:"online-down"},[s("div",{staticClass:"item",on:{click:function(e){return e.stopPropagation(),t.changeOnline(1)}}},[t.online?s("span",{staticClass:"iconfont iconduihao"}):t._e(),s("i",{staticClass:"green"}),t._v("在线")]),s("div",{staticClass:"item",on:{click:function(e){return e.stopPropagation(),t.changeOnline(0)}}},[t.online?t._e():s("span",{staticClass:"iconfont iconduihao"}),s("i"),t._v("下线")])])])]),s("div",{staticClass:"out-btn",on:{click:function(e){return e.stopPropagation(),t.outLogin(e)}}},[t._v("退出登录")])],1),s("div",{staticClass:"right-menu"},t._l(t.menuList,(function(e,i){return s("div",{key:i,staticClass:"menu-item",class:{on:i==t.curIndex},on:{click:function(s){return s.stopPropagation(),t.selectTab(e)}}},[t._v(t._s(e.title))])})),0)])},c=[],l=s("2f62");function d(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function u(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?d(s,!0).forEach((function(e){f(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):d(s).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function f(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var m={name:"baseHeader",props:{kefuInfo:{type:Object,default:function(){return{}}},online:{type:Boolean|Number,default:!0}},computed:u({},Object(l["e"])("admin/layout",["logoutConfirm"])),data:function(){return{menuList:[{key:0,title:"客户信息"},{key:1,title:"交易订单"},{key:2,title:"商品信息"}],curIndex:0,isOnline:!1}},mounted:function(){var t=this;document.addEventListener("click",(function(){t.isOnline=!1}))},methods:u({},Object(l["b"])("admin/account",["logout","logoutKefu"]),{selectTab:function(t){this.curIndex=t.key,this.bus.$emit("selectRightMenu",this.curIndex)},setOnline:function(){this.isOnline=!this.isOnline},changeOnline:function(t){this.$emit("setOnline",t),this.isOnline=!1},outLogin:function(){var t=this;this.$Modal.confirm({title:"退出登录确认",content:"您确定退出登录当前账户吗？打开的标签页和个人设置将会保存。",onOk:function(){t.logoutKefu({confirm:!1,vm:t})},onCancel:function(){}})},bindSearch:function(t){this.$emit("search",t.target.value)},inputChange:function(t){this.bus.$emit("change",t.target.value)}})},p=m,h=(s("c1bb"),s("2877")),v=Object(h["a"])(p,o,c,!1,null,"0dda5150",null),g=v.exports,_=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"chatList"},[s("div",{staticClass:"tab-head"},t._l(t.hdTab,(function(e,i){return s("div",{key:i,staticClass:"item",class:{active:e.key==t.hdTabCur},on:{click:function(s){return t.changeTab(e)}}},[t._v(t._s(e.title))])})),0),s("div",{staticClass:"scroll-box"},[t.userList.length>0?s("vue-scroll",{attrs:{ops:t.ops},on:{"handle-scroll":t.handleScroll}},t._l(t.userList,(function(e,i){return s("div",{key:i,staticClass:"chat-item",class:{active:t.curId==e.id},on:{click:function(s){return t.selectUser(e)}}},[s("div",{staticClass:"avatar"},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.avatar,expression:"item.avatar"}],attrs:{alt:""}}),s("div",{staticClass:"status",class:{off:0==e.online}})]),s("div",{staticClass:"user-info"},[s("div",{staticClass:"hd"},[s("span",{staticClass:"name line1"},[t._v(t._s(e.nickname))]),2==e.type?[s("span",{staticClass:"label"},[t._v("小程序")])]:t._e(),3==e.type?[s("span",{staticClass:"label H5"},[t._v("H5")])]:t._e(),1==e.type?[s("span",{staticClass:"label wechat"},[t._v("公众号")])]:t._e(),0==e.type?[s("span",{staticClass:"label pc"},[t._v("PC端")])]:t._e()],2),s("div",{staticClass:"bd line1"},[e.message_type<=2?[t._v(t._s(e.message))]:t._e(),3==e.message_type?[t._v("[图片]")]:t._e(),5==e.message_type?[t._v("[商品]")]:t._e(),6==e.message_type?[t._v("[订单]")]:t._e()],2)]),s("div",{staticClass:"right-box"},[s("div",{staticClass:"time"},[t._v(t._s(t._f("toDay")(e.update_time)))]),s("div",{staticClass:"num"},[s("Badge",{attrs:{count:e.mssage_num}},[s("a",{staticClass:"demo-badge",attrs:{href:"#"}})])],1)])])})),0):s("empty",{attrs:{msg:"暂无用户列表",status:"1"}})],1)])},b=[],C=s("49ea"),y=s("5a0c"),k=s.n(y),I=s("42e3"),w=s("8b1f"),S={name:"chatList",props:{userOnline:{type:Object,default:function(){return{}}},newRecored:{type:Object,default:function(){return{}}},searchData:{type:String,default:""},isShow:{type:Boolean,default:!1}},components:{HappyScroll:r["HappyScroll"],empty:w["a"]},watch:{userOnline:{handler:function(t,e){var s=this;t.hasOwnProperty("to_uid")&&this.userList.forEach((function(e,i){e.to_uid==t.to_uid&&(e.online=t.online,1==t.online&&s.$Notice.info({title:"上线通知",desc:"".concat(e.nickname,"上线")}))}))},deep:!0},searchData:{handler:function(t,e){t!=e&&(this.nickname=t,this.page=1,this.isScroll=!0,this.userList=[],this.isSearch=!0,this.getList())},deep:!0},isShow:{handler:function(t,e){t&&this.wsStart()},deep:!0}},data:function(){return{hdTabCur:0,hdTab:[{key:0,title:"用户列表"},{key:1,title:"游客列表"}],userList:[],curId:"",page:1,limit:15,isScroll:!0,nickname:"",isSearch:!1,ops:{vuescroll:{mode:"native",enable:!1,tips:{deactive:"Push to Load",active:"Release to Load",start:"Loading...",beforeDeactive:"Load Successfully!"},auto:!1,autoLoadDistance:0,pullRefresh:{enable:!1},pushLoad:{enable:!0,auto:!0,autoLoadDistance:10}},bar:{background:"#393232",opacity:".5",size:"5px"}}}},filters:{toDay:function(t){return t?k.a.unix(t).format("M月D日 HH:mm"):""}},mounted:function(){var t=this;this.bus.$on("change",(function(e){t.nickname=e})),this.getList()},methods:{wsStart:function(){var t=this,e=this;this.bus.pageWs.then((function(s){s.$on("transfer",(function(s){var i=!1;e.userList.forEach((function(a,n,r){if(s.recored.id==a.id){if(i=!0,s.recored.is_tourist==e.hdTabCur){var o=s.recored;r.splice(n,1),0==n&&(t.$emit("setDataId",o),o.mssage_num=0),r.unshift(o)}t.$Notice.info({title:"您有一条转接消息！"})}})),i||s.recored.is_tourist==t.hdTabCur&&t.userList.unshift(s.recored),e.$emit("changeLen",1)})),s.$on("mssage_num",(function(s){if(s.recored.id){var i=!1;e.userList.forEach((function(t,a,n){if(s.recored.id==t.id&&(i=!0,s.recored.is_tourist==e.hdTabCur)){var r=s.recored;n.splice(a,1),n.unshift(r)}})),i||s.recored.is_tourist==t.hdTabCur&&t.userList.unshift(s.recored)}e.$emit("changeLen",1),s.recored.is_tourist!=t.hdTabCur&&s.recored.id&&t.$Notice.info({title:t.hdTabCur?"用户发来消息啦！":"游客发来消息啦！"})}))}))},changeTab:function(t){this.hdTabCur!=t.key&&(this.hdTabCur=t.key,this.isScroll=!0,this.page=1,this.userList=[],this.$emit("changeType",t.key),this.getList())},getList:function(){var t=this;this.isScroll&&Object(I["G"])({nickname:this.nickname,page:this.page,limit:this.limit,is_tourist:this.hdTabCur}).then((function(e){t.$emit("changeLen",e.data.length),e.data.length>0?(e.data[0].mssage_num=0,t.isScroll=e.data.length>=t.limit,t.userList=t.userList.concat(e.data),1==t.page&&e.data.length>0&&!t.isSearch&&(t.curId=e.data[0].id,t.$emit("setDataId",e.data[0])),t.page++):t.$emit("setDataId",0)}))},chartReachBottom:function(){this.getList()},selectUser:function(t){this.curId!=t.id&&(t.mssage_num=0,this.curId=t.id,this.$emit("setDataId",t))},handleScroll:function(t,e,s){1==t.process&&this.getList()}}},x=S,O=(s("e228"),Object(h["a"])(x,_,b,!1,null,"419cb481",null)),L=O.exports,T=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"right-wrapper"},[0==t.curStatus?[t.activeUserInfo?s("div",{staticClass:"user-wrapper"},[s("div",{staticClass:"user"},[s("div",{staticClass:"avatar"},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.activeUserInfo.avatar,expression:"activeUserInfo.avatar"}],attrs:{alt:""}})]),s("div",{staticClass:"name line1"},[t._v(t._s(t.activeUserInfo.nickname))]),s("div",{staticClass:"label"},[2==t.webType?[s("span",{staticClass:"label routine"},[t._v("小程序")])]:t._e(),3==t.webType?[s("span",{staticClass:"label H5"},[t._v("H5")])]:t._e(),1==t.webType?[s("span",{staticClass:"label wechat"},[t._v("公众号")])]:t._e(),0==t.webType?[s("span",{staticClass:"label pc"},[t._v("PC端")])]:t._e()],2)]),s("div",{staticClass:"user-info"},[s("div",{staticClass:"item"},[s("span",[t._v("手机号")]),t._v("\n            "+t._s(t.activeUserInfo.phone||"暂无")+"\n          ")]),s("div",{staticClass:"item"},[s("span",[t._v("分组")]),s("Select",{staticStyle:{flex:"1"},attrs:{size:"small"},on:{"on-change":t.onChange},model:{value:t.activeUserInfo.group_id,callback:function(e){t.$set(t.activeUserInfo,"group_id",e)},expression:"activeUserInfo.group_id"}},t._l(t.userGroup,(function(e){return s("Option",{key:e.value,attrs:{value:e.id}},[t._v(t._s(e.group_name))])})),1)],1),s("div",{staticClass:"label-list",on:{click:function(e){e.stopPropagation(),t.isUserLabel=!0}}},[s("span",[t._v("用户标签")]),s("div",{staticClass:"con"},t._l(t.activeUserInfo.labelNames,(function(e){return s("div",{staticClass:"label-item"},[t._v("\n                "+t._s(e)+"\n              ")])})),0),s("div",{staticClass:"right-icon"},[s("Icon",{attrs:{type:"ios-arrow-forward",size:"14"}})],1)])]),s("div",{staticClass:"user-info"},[s("div",{staticClass:"item"},[s("span",[t._v("会员等级")]),t._v("\n            "+t._s(t.activeUserInfo.level_name)+"\n          ")]),s("div",{staticClass:"item"},[s("span",[t._v("推荐人")]),t._v("\n            "+t._s(t.activeUserInfo.spread_name)+"\n          ")]),s("div",{staticClass:"item"},[s("span",[t._v("用户类型")]),t._v("\n            "+t._s(t._f("typeFilters")(t.activeUserInfo.user_type))+"\n          ")]),s("div",{staticClass:"item"},[s("span",[t._v("余额")]),t._v("\n            "+t._s(t.activeUserInfo.now_money)+"\n          ")]),s("div",{staticClass:"item"},[s("span",[t._v("推广员")]),t._v(t._s(t.activeUserInfo.is_promoter?"是":"否")+"\n          ")]),s("div",{staticClass:"item"},[s("span",[t._v("生日")]),t._v("\n            "+t._s(t._f("getDay")(t.activeUserInfo.birthday))+"\n          ")])])]):s("empty",{attrs:{status:"2",msg:"暂无用户信息"}})]:t._e(),1==t.curStatus?[s("div",{staticClass:"order-wrapper"},[s("div",{staticClass:"tab-head"},t._l(t.menuList,(function(e,i){return s("div",{key:i,staticClass:"tab-item",class:{active:t.orderConfig.type===e.key},on:{click:function(s){return s.stopPropagation(),t.bindTab(e)}}},[t._v("\n            "+t._s(e.title)+"\n          ")])})),0),s("div",{staticClass:"search-box"},[s("Input",{staticClass:"search_box",attrs:{prefix:"ios-search",placeholder:"搜索订单编号"},on:{"on-enter":t.orderSearch},model:{value:t.orderConfig.searchTxt,callback:function(e){t.$set(t.orderConfig,"searchTxt",e)},expression:"orderConfig.searchTxt"}})],1),t.orderList.length>0?s("div",[s("Scroll",{staticClass:"right-scroll",attrs:{"on-reach-bottom":t.orderReachBottom,height:"650"}},[s("div",{staticClass:"order-list"},t._l(t.orderList,(function(e,i){return s("div",{key:i,staticClass:"order-item"},[s("div",{staticClass:"head"},[s("div",{staticClass:"left"},[s("div",{staticClass:"font-box"},[1==e.status?s("span",{staticClass:"iconfont icondaishouhuo"}):t._e(),0==e.status?s("span",{staticClass:"iconfont icondaifahuo"}):t._e(),2==e.status?s("span",{staticClass:"iconfont icondaipingjia"}):t._e(),e.status<0?s("span",{staticClass:"iconfont iconshouhou-tuikuan"}):t._e()]),s("span",[t._v("\n\t\t\t\t\t\t\t\t\t\t\t"+t._s(e._status._title)),e.refund.length&&-2!=e._status._type?s("span",[t._v(t._s(e.is_all_refund?",退款中":",部分退款中"))]):t._e()])]),s("div",{staticClass:"time"},[t._v(t._s(e._pay_time))])]),s("div",{staticClass:"goods-list",class:{auto:!t.isOrderHidden}},t._l(e.cartInfo,(function(e){return s("div",{key:e.id,staticClass:"goods-item"},[s("div",{staticClass:"img-box"},[s("img",{attrs:{src:e.productInfo.image,alt:""}})]),s("div",{staticClass:"info"},[s("div",{staticClass:"name line1"},[1==e.is_gift?s("span",{staticClass:"label"},[t._v("[赠品]")]):t._e(),t._v("\n                        "+t._s(e.productInfo.store_name)+"\n                      ")]),s("div",{staticClass:"sku line1"},[t._v("\n                        "+t._s(e.productInfo.attrInfo.suk)+"\n                      ")]),s("div",{staticClass:"price"},[t._v("\n                        ¥"+t._s(e.productInfo.attrInfo.price?e.productInfo.attrInfo.price:e.productInfo.price)+" x "+t._s(e.cart_num)+"\n                      ")])])])})),0),e.cartInfo.length>2?s("div",{staticClass:"more-box",on:{click:function(e){e.stopPropagation(),t.isOrderHidden=!t.isOrderHidden}}},[s("span",[t._v(t._s(t.isOrderHidden?"展开":"合上"))])]):t._e(),s("div",{staticClass:"order-info"},[s("div",{staticClass:"info-item"},[s("span",[t._v("订单编号：")]),t._v(t._s(e.order_id)+"\n                  ")]),-1==t.orderConfig.type?s("div",{staticClass:"info-item"},[s("span",[t._v("申请时间：")]),t._v(t._s(e.add_time||"--")+"\n                  ")]):s("div",{staticClass:"info-item"},[s("span",[t._v("付款时间：")]),t._v(t._s(e._pay_time||"--")+"\n                  ")]),-1!=t.orderConfig.type?s("div",{staticClass:"info-item"},[s("span",[t._v("邮费：")]),t._v("¥ "+t._s(e.pay_postage)+"\n                  ")]):t._e(),s("div",{staticClass:"info-item"},[s("span",[t._v(t._s(-1!=t.orderConfig.type?"实收款":"申请金额")+"：")]),t._v("¥ "+t._s(e.pay_price)+"\n                  ")])]),s("div",{staticClass:"btn-wrapper"},[2===e.shipping_type||1!=e._status._type||null!==e.pinkStatus&&2!==e.pinkStatus||0==e._status._type?t._e():s("Button",{staticClass:"btn",attrs:{disabled:t.openErp,type:"primary"},on:{click:function(s){return s.stopPropagation(),t.openDelivery(e)}}},[t._v("发货")]),6!=e.refund_type&&1==e.paid?s("Button",{staticClass:"btn",class:t.openErp?"on":"",staticStyle:{color:"#1890ff","border-color":"#1890ff"},attrs:{disabled:t.openErp,type:"info",ghost:""},on:{click:function(s){return s.stopPropagation(),t.orderRecord(e.id)}}},[t._v("退款")]):t._e(),0==e._status._type?s("Button",{staticClass:"btn",class:t.openErp?"on":"",staticStyle:{color:"#1890ff","border-color":"#1890ff"},attrs:{disabled:t.openErp,type:"info",ghost:""},on:{click:function(s){return s.stopPropagation(),t.orderEdit(e.id)}}},[t._v("改价")]):t._e(),s("Button",{staticClass:"btn",staticStyle:{color:"#1890ff","border-color":"#1890ff"},attrs:{type:"info",ghost:""},on:{click:function(s){return s.stopPropagation(),t.bindRemark(e)}}},[t._v("备注")])],1)])})),0)])],1):t._e(),0==t.orderList.length&&""===t.orderConfig.type?s("empty",{attrs:{status:"3",msg:"暂无订单信息"}}):t._e(),0==t.orderList.length&&0===t.orderConfig.type?s("empty",{attrs:{status:"4",msg:"暂无未支付订单"}}):t._e(),0==t.orderList.length&&1==t.orderConfig.type?s("empty",{attrs:{status:"5",msg:"暂无未发货订单"}}):t._e(),0==t.orderList.length&&-1==t.orderConfig.type?s("empty",{attrs:{status:"6",msg:"暂无退款订单"}}):t._e()],1)]:t._e(),2==t.curStatus?[s("div",{staticClass:"goods-wrapper"},[s("div",{staticClass:"goods-tab"},t._l(t.goodsTab,(function(e,i){return s("div",{key:i,staticClass:"tab-item",class:{active:t.goodsConfig.type===e.key},on:{click:function(s){return s.stopPropagation(),t.bindGoodsTab(e)}}},[t._v("\n            "+t._s(e.title)+"\n          ")])})),0),s("div",{staticClass:"search-box"},[s("Input",{staticClass:"search_box",attrs:{prefix:"ios-search",placeholder:"搜索商品名称/ID"},on:{"on-enter":t.productSearch},model:{value:t.storeName,callback:function(e){t.storeName=e},expression:"storeName"}})],1),t.goodsConfig.buyList.length>0?s("div",{staticClass:"list-wrapper"},[s("Scroll",{staticClass:"right-scroll",attrs:{height:"650"}},t._l(t.goodsConfig.buyList,(function(e){return s("div",{staticClass:"list-item"},[s("div",{staticClass:"img-box"},[s("img",{attrs:{src:e.image,alt:""}})]),s("div",{staticClass:"info"},[s("div",{staticClass:"name line1"},[t._v(t._s(e.store_name))]),s("div",{staticClass:"sku"},[s("span",[t._v("库存："+t._s(e.stock))]),s("span",[t._v("销量："+t._s(e.sales))])]),s("div",{staticClass:"price"},[s("span",[t._v("¥"+t._s(e.price))]),s("div",{staticClass:"push",on:{click:function(s){return s.stopPropagation(),t.pushGoods(e)}}},[t._v("推送")])])])])})),0)],1):s("empty",{attrs:{status:"3",msg:"暂无商品信息"}})],1)]:t._e(),s("Modal",{attrs:{title:"订单发送货","footer-hide":!0,width:"1000"},model:{value:t.isDelivery,callback:function(e){t.isDelivery=e},expression:"isDelivery"}},[t.isDelivery?s("delivery",{attrs:{exportOpen:t.exportOpen,orderId:t.orderId,orderType:t.orderType},on:{close:t.deliveryClose,ok:t.deliveryOk}}):t._e()],1),s("Modal",{staticClass:"none-radius",attrs:{title:"请修改内容","footer-hide":!0,mask:!0,width:"520",closable:!1},model:{value:t.isRemarks,callback:function(e){t.isRemarks=e},expression:"isRemarks"}},[t.isRemarks?s("remarks",{attrs:{remarkId:t.remarkId,remarkTitle:t.remarkTitle,itemId:t.itemId,remarkType:t.orderConfig.type},on:{close:t.deliveryClose,remarkSuccess:t.remarkSuccess}}):t._e()],1),s("Modal",{staticClass:"label-box",attrs:{"footer-hide":!0,width:"320",closable:!1,mask:!0},model:{value:t.isUserLabel,callback:function(e){t.isUserLabel=e},expression:"isUserLabel"}},[s("p",{staticClass:"label-head",attrs:{slot:"header"},slot:"header"},[s("span",[t._v("选择用户标签")])]),t.isUserLabel?s("userLabel",{attrs:{uid:t.uid},on:{close:t.deliveryClose,editLabel:t.editLabel}}):t._e()],1)],2)},$=[],j=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("Form",{ref:"formValidate",attrs:{model:t.formValidate,rules:t.ruleInline,inline:""}},[s("FormItem",{staticClass:"form-item",attrs:{label:"选择类型：","label-position":"right","label-width":100}},[s("RadioGroup",{model:{value:t.formValidate.gender,callback:function(e){t.$set(t.formValidate,"gender",e)},expression:"formValidate.gender"}},t._l(t.radioList,(function(e,i){return s("Radio",{key:i,attrs:{label:e.key}},[t._v(t._s(e.title))])})),1)],1),1==t.formValidate.gender&&"0"!==t.exportOpen?s("FormItem",{key:"test0",staticClass:"form-item",attrs:{label:"发货类型：","label-position":"right","label-width":100}},[s("RadioGroup",{model:{value:t.formValidate.shipStatus,callback:function(e){t.$set(t.formValidate,"shipStatus",e)},expression:"formValidate.shipStatus"}},t._l(t.shipType,(function(e,i){return s("Radio",{key:i,attrs:{label:e.key}},[t._v(t._s(e.title))])})),1)],1):t._e(),1==t.formValidate.gender&&1==t.formValidate.shipStatus?s("div",{key:"test1"},[s("FormItem",{staticClass:"form-item",attrs:{label:"快递公司：",prop:"logisticsCode","label-position":"right","label-width":100}},[s("Select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择","label-in-value":!0},on:{"on-change":t.bindChange},model:{value:t.formValidate.logisticsCode,callback:function(e){t.$set(t.formValidate,"logisticsCode",e)},expression:"formValidate.logisticsCode"}},t._l(t.logisticsList,(function(e,i){return s("Option",{key:i,attrs:{value:e.code}},[t._v(t._s(e.value))])})),1)],1),s("FormItem",{staticClass:"form-item",attrs:{label:"快递单号：",prop:"number","label-position":"right","label-width":100}},[s("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入快递单号"},model:{value:t.formValidate.number,callback:function(e){t.$set(t.formValidate,"number",e)},expression:"formValidate.number"}}),"shunfeng"==t.formValidate.logisticsCode?s("div",{staticClass:"trip"},[t._v("\n          顺丰请输入单号 : 收件人或寄件人手机号后四位\n        ")]):t._e(),"shunfeng"==t.formValidate.logisticsCode?s("div",{staticClass:"trip"},[t._v("\n          例如：SF000000000000:3941\n        ")]):t._e()],1)],1):t._e(),1==t.formValidate.gender&&2==t.formValidate.shipStatus?s("div",{key:"test2"},[s("FormItem",{staticClass:"form-item",attrs:{label:"快递公司：",prop:"logisticsCode","label-position":"right","label-width":100}},[s("Select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",filterable:"","label-in-value":!0},on:{"on-change":t.bindChange},model:{value:t.formValidate.logisticsCode,callback:function(e){t.$set(t.formValidate,"logisticsCode",e)},expression:"formValidate.logisticsCode"}},t._l(t.logisticsList,(function(e,i){return s("Option",{key:i,attrs:{value:e.code}},[t._v(t._s(e.value))])})),1)],1),t.orderTempList.length>0?s("FormItem",{staticClass:"form-item",attrs:{label:"电子面单：","label-position":"right","label-width":100}},[s("Select",{staticStyle:{width:"80%"},attrs:{placeholder:"请选择电子面单"},model:{value:t.formValidate.electronic,callback:function(e){t.$set(t.formValidate,"electronic",e)},expression:"formValidate.electronic"}},t._l(t.orderTempList,(function(e,i){return s("Option",{key:i,attrs:{value:e.temp_id}},[t._v(t._s(e.title))])})),1),s("Button",{staticStyle:{flex:"1","margin-left":"21px"},on:{click:t.lookImg}},[t._v("预览")]),s("viewer",{ref:"viewer",staticClass:"viewer",staticStyle:{display:"none"},attrs:{images:t.orderTempList},on:{inited:t.inited}},t._l(t.orderTempList,(function(t){return s("img",{key:t.id,staticClass:"image",attrs:{src:t.pic}})})),0)],1):t._e(),s("FormItem",{staticClass:"form-item",attrs:{label:"寄件人姓名：",prop:"sendName","label-position":"right","label-width":100}},[s("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入寄件人姓名"},model:{value:t.formValidate.sendName,callback:function(e){t.$set(t.formValidate,"sendName",e)},expression:"formValidate.sendName"}})],1),s("FormItem",{staticClass:"form-item",attrs:{label:"寄件人电话：",prop:"sendPhone","label-position":"right","label-width":100}},[s("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入寄件人电话"},model:{value:t.formValidate.sendPhone,callback:function(e){t.$set(t.formValidate,"sendPhone",e)},expression:"formValidate.sendPhone"}})],1),s("FormItem",{staticClass:"form-item",attrs:{label:"寄件人地址：",prop:"sendAddress","label-position":"right","label-width":100}},[s("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入寄件人地址"},model:{value:t.formValidate.sendAddress,callback:function(e){t.$set(t.formValidate,"sendAddress",e)},expression:"formValidate.sendAddress"}})],1)],1):t._e(),2==t.formValidate.gender?s("div",{key:"test3"},[s("FormItem",{staticClass:"form-item",attrs:{label:"选择送货人：","label-position":"right","label-width":100}},[s("Select",{staticStyle:{width:"100%"},attrs:{placeholder:"选择送货人"},model:{value:t.formValidate.postPeople,callback:function(e){t.$set(t.formValidate,"postPeople",e)},expression:"formValidate.postPeople"}},t._l(t.deliveryList,(function(e,i){return s("Option",{key:i,attrs:{value:e.uid}},[t._v(t._s(e.nickname))])})),1)],1)],1):t._e(),3==t.formValidate.gender?s("div",[s("FormItem",{staticClass:"form-item",attrs:{label:"备注：",props:"msg","label-position":"right","label-width":100}},[s("Input",{attrs:{placeholder:"备注"},model:{value:t.formValidate.msg,callback:function(e){t.$set(t.formValidate,"msg",e)},expression:"formValidate.msg"}})],1)],1):t._e(),t.splitOrder>1&&3!=t.formValidate.gender?s("div",[s("FormItem",{attrs:{label:"分单发货：","label-width":100}},[s("i-switch",{attrs:{size:"large",disabled:8===t.orderStatus},on:{"on-change":t.changeSplitStatus},model:{value:t.splitSwitch,callback:function(e){t.splitSwitch=e},expression:"splitSwitch"}},[s("span",{attrs:{slot:"open"},slot:"open"},[t._v("开启")]),s("span",{attrs:{slot:"close"},slot:"close"},[t._v("关闭")])]),s("div",{staticClass:"trips"},[s("p",[t._v("\n            可选择表格中的商品单独发货，发货后会生成新的订单且不能撤回，请谨慎操作！\n          ")])]),t.splitSwitch&&t.manyFormValidate.length?s("Table",{attrs:{data:t.manyFormValidate,columns:t.header,border:""},on:{"on-selection-change":t.selectOne},scopedSlots:t._u([{key:"image",fn:function(e){var i=e.row;e.index;return[s("div",{staticClass:"product-data"},[s("img",{staticClass:"image",attrs:{src:i.cart_info.productInfo.image}}),s("div",{staticClass:"line2"},[t._v("\n                "+t._s(i.cart_info.productInfo.store_name)+"\n              ")])])]}},{key:"value",fn:function(e){var i=e.row;e.index;return[s("div",{staticClass:"product-data"},[s("div",[t._v(t._s(i.cart_info.productInfo.attrInfo.suk))])])]}},{key:"sellPrice",fn:function(e){var i=e.row;e.index;return[s("div",[t._v("\n              "+t._s(i.cart_info.productInfo.attrInfo?i.cart_info.productInfo.attrInfo.price:i.cart_info.productInfo.price)+"\n            ")])]}},{key:"price",fn:function(e){var i=e.row;e.index;return[s("div",{staticClass:"product-data"},[s("div",[t._v(t._s(i.cart_info.truePrice))])])]}}],null,!1,858089823)}):t._e()],1)],1):t._e(),s("div",{staticClass:"mask-footer"},[s("Button",{attrs:{type:"primary"},on:{click:function(e){return t.handleSubmit("formValidate")}}},[t._v("提交")]),s("Button",{on:{click:t.close}},[t._v("取消")])],1)],1)],1)},D=[],M=s("f8b7");function V(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function P(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?V(s,!0).forEach((function(e){E(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):V(s).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function E(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var N={name:"delivery",props:{isShow:{type:Boolean,default:!1},orderId:{type:String|Number,default:""},exportOpen:{type:String,default:"0"},orderType:{type:Number,default:0}},computed:P({},Object(l["e"])("admin/order",["splitOrder"])),watch:{"formValidate.shipStatus":{handler:function(t,e){var s=this;1==t&&this.getOrderExport(""),2!=t||this.formValidate.sendName||(Object(I["n"])().then((function(t){s.formValidate.sendName=t.data.to_name,s.formValidate.sendPhone=t.data.to_tel,s.formValidate.sendAddress=t.data.to_add})),this.getOrderExport(1)),this.$refs["formValidate"].resetFields()},deep:!0},"formValidate.gender":{handler:function(t,e){this.$refs["formValidate"].resetFields()},deep:!0}},data:function(){var t=this;return{productType:0,splitSwitch:!0,shipType:[{key:1,title:"手动填写"},{key:2,title:"电子面单打印"}],radioList:[{key:1,title:"发货"},{key:2,title:"送货"},{key:3,title:"虚拟"}],ruleInline:{logisticsCode:[{required:!0,message:"请选择快递公司",trigger:"change"}],number:[{required:!0,message:"请填写快递单号",trigger:"change"}],sendName:[{required:!0,message:"请填写寄件人姓名",trigger:"change"}],sendPhone:[{required:!0,message:"请填写寄件人手机",trigger:"change"},{pattern:/^1[3456789]\d{9}$/,message:"手机号码格式不正确",trigger:"blur"}],sendAddress:[{required:!0,message:"请填写寄件人地址",trigger:"change"}],msg:[{required:!0,message:"请填写备注信息",trigger:"change"}]},formValidate:{gender:1,shipStatus:1,logisticsCode:"",logisticsName:"",number:"",electronic:"",sendName:"",sendPhone:"",sendAddress:"",postPeople:"",msg:""},logisticsList:[],orderTempList:[],deliveryList:[],manyFormValidate:[],orderStatus:0,selectData:[],header:[{type:"selection",width:60,align:"center"},{title:"商品信息",slot:"image",width:200,align:"center"},{title:"规格",slot:"value",align:"center",minWidth:120},{title:"商品售价",slot:"sellPrice",align:"center",minWidth:100},{title:"商品优惠价",slot:"price",align:"center",minWidth:100},{title:"总数",key:"cart_num",align:"center",minWidth:80},{title:"待发数量",key:"surplus_num",align:"center",width:180,render:function(e,s){return e("div",[e("InputNumber",{props:{min:1,max:s.row.numShow,value:s.row.surplus_num||1},on:{"on-change":function(e){s.row.surplus_num=e||1,t.manyFormValidate[s.index]=s.row,t.selectData.forEach((function(e,i){e.cart_id===s.row.cart_id&&t.selectData.splice(i,1,s.row)}))}}})])}}]}},mounted:function(){var t=this;this.getOrderExport(),this.getDelivery(),this.$nextTick((function(e){t.getCartInfo(t.orderType)}))},methods:{getDelivery:function(){var t=this;Object(I["r"])().then((function(e){t.deliveryList=e.data}))},inited:function(t){this.$viewer=t},getOrderExport:function(t){var e=this;Object(I["t"])(t||"").then((function(t){e.logisticsList=t.data}))},changeSplitStatus:function(t){var e=this;t&&Object(M["O"])(this.orderId).then((function(t){var s=t.data;s.forEach((function(t){t.numShow=t.surplus_num})),e.manyFormValidate=s}))},getCartInfo:function(t){var e=this;this.$set(this,"orderStatus",t),this.$set(this,"splitSwitch",8===t),Object(M["O"])(this.orderId).then((function(t){var s=t.data;s.forEach((function(t){t.numShow=t.surplus_num})),e.manyFormValidate=s,e.productType=s[0].product_type,3==e.productType&&(e.radioList.splice(0,2),e.formValidate.gender=3)}))},selectOne:function(t){this.selectData=t},handleSubmit:function(t){var e=this;if(1==this.formValidate.gender&&this.$refs[t].validate((function(t){var s={};if(s.type=e.formValidate.gender,s.express_record_type=parseFloat(e.formValidate.shipStatus),s.delivery_name=e.formValidate.logisticsName,s.delivery_code=e.formValidate.logisticsCode,s.cart_ids=[],1==e.formValidate.gender&&1==e.formValidate.shipStatus&&(s.delivery_id=e.formValidate.number),1==e.formValidate.gender&&2==e.formValidate.shipStatus&&(s.to_name=e.formValidate.sendName,s.to_tel=e.formValidate.sendPhone,s.to_addr=e.formValidate.sendAddress,s.express_temp_id=e.formValidate.electronic),t&&!e.splitSwitch)console.log(s),Object(I["q"])(e.orderId,s).then((function(t){e.$Message.success(t.msg),e.$emit("ok")})).catch((function(t){e.$Message.error(t.msg)}));else if(t&&e.splitSwitch){var i={id:e.orderId,datas:P({},s)};i.datas.cart_ids=[],e.selectData.forEach((function(t){i.datas.cart_ids.push({cart_id:t.cart_id,cart_num:t.surplus_num})})),console.log(i,"哈哈哈"),Object(I["Q"])(i).then((function(t){e.modals=!1,e.$Message.success(t.msg),e.$emit("ok"),e.splitSwitch=!1})).catch((function(t){e.$Message.error(t.msg)}))}})),2==this.formValidate.gender){var s={};if(this.deliveryList.forEach((function(t,i){t.uid==e.formValidate.postPeople&&(s=t)})),this.splitSwitch){var i={type:this.formValidate.gender,sh_delivery_name:s.wx_name,sh_delivery_id:s.phone,sh_delivery_uid:s.uid,cart_ids:[]};this.selectData.forEach((function(t){i.cart_ids.push({cart_id:t.cart_id,cart_num:t.surplus_num})}));var a={id:this.orderId,datas:P({},i)};Object(I["Q"])(a).then((function(t){e.modals=!1,e.$Message.success(t.msg),e.$emit("ok"),e.splitSwitch=!1})).catch((function(t){console.log("222"),e.$Message.error(t.msg)}))}else Object(I["q"])(this.orderId,{type:this.formValidate.gender,sh_delivery_name:s.wx_name,sh_delivery_id:s.phone,sh_delivery_uid:s.uid}).then((function(t){e.$Message.success(t.msg),e.$emit("ok")})).catch((function(t){e.$Message.error(t.msg)}))}3==this.formValidate.gender&&Object(I["q"])(this.orderId,{type:this.formValidate.gender,remark:this.formValidate.msg}).then((function(t){e.$Message.success(t.msg),e.$emit("ok")})).catch((function(t){e.$Message.error(t.msg)}))},close:function(){this.$emit("close")},bindChange:function(t){var e=this;this.formValidate.logisticsName=t.label,2==this.formValidate.shipStatus&&Object(I["x"])({com:t.value}).then((function(t){e.orderTempList=t.data.data}))},lookImg:function(){var t=this;this.formValidate.electronic?this.orderTempList.forEach((function(e,s){e.temp_id==t.formValidate.electronic&&t.$viewer.view(s)})):this.$Message.error("请选择电子面单")}}},U=N,R=(s("a7e1"),Object(h["a"])(U,j,D,!1,null,"73dece3a",null)),A=R.exports,F=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("Form",{ref:"formValidate",attrs:{model:t.formValidate,rules:t.ruleInline,inline:""}},[s("FormItem",{staticClass:"form-item",attrs:{label:"备注：",prop:"con","label-position":"right","label-width":100}},[s("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入备注",maxlength:"200",type:"textarea",rows:5,"show-word-limit":""},model:{value:t.formValidate.con,callback:function(e){t.$set(t.formValidate,"con",e)},expression:"formValidate.con"}})],1),s("div",{staticClass:"mask-footer"},[s("Button",{attrs:{type:"primary"},on:{click:function(e){return t.handleSubmit("formValidate")}}},[t._v("提交")]),s("Button",{on:{click:t.close}},[t._v("取消")])],1)],1)],1)},B=[];function H(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var z={name:"remarks",props:{remarkId:{type:String,default:""},itemId:{type:Number,default:0},remarkTitle:{type:String,default:""},remarkType:{default:1,type:Number}},data:function(){return H({formValidate:{con:""},ruleInline:{con:[{required:!0,message:"请输入备注信息",trigger:"change"}]}},"formValidate",{con:""})},mounted:function(){this.getremark()},methods:{getremark:function(){this.formValidate.con=this.remarkTitle},handleSubmit:function(t){var e=this;console.log(this.itemId),this.$refs[t].validate((function(t){t&&(-1==e.remarkType?I["I"]:I["w"])({order_id:e.remarkId,id:e.itemId,remark:e.formValidate.con}).then((function(t){e.$Message.success(t.msg),e.$emit("remarkSuccess")})).catch((function(t){e.$Message.error(t.msg)}))}))},close:function(){this.$emit("close")}}},W=z,G=(s("4e4b"),Object(h["a"])(W,F,B,!1,null,"fe4ef712",null)),q=G.exports,Y=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"label-wrapper"},[s("div",{staticClass:"list-box"},[t._l(t.labelList,(function(e,i){return t.isUser?s("div",{key:i,staticClass:"label-box"},[s("div",{staticClass:"title"},[t._v(t._s(e.name))]),s("div",{staticClass:"list"},t._l(e.label,(function(e,i){return s("div",{key:i,staticClass:"label-item",class:{on:e.disabled},on:{click:function(s){return t.selectLabel(e)}}},[t._v(t._s(e.label_name))])})),0)]):t._e()})),t.isUser?t._e():s("div",[t._v("暂无标签")])],2),s("div",{staticClass:"footer"},[s("Button",{staticClass:"btns",attrs:{type:"primary"},on:{click:t.subBtn}},[t._v("确定")]),s("Button",{staticClass:"btns",attrs:{type:"primary",ghost:""},on:{click:t.cancel}},[t._v("取消")])],1)])},J=[],K={name:"userLabel",props:{uid:{type:String|Number,default:""}},data:function(){return{isUser:!1,labelList:[],activeIds:[]}},mounted:function(){this.getList()},methods:{getList:function(){var t=this;Object(I["V"])(this.uid).then((function(e){e.data.map((function(e){t.isUser=!0,e.label.map((function(e){e.disabled&&t.activeIds.push(e.id)}))})),t.labelList=e.data}))},selectLabel:function(t){if(t.disabled){var e=this.activeIds.indexOf(t.id);this.activeIds.splice(e,1),t.disabled=!1}else this.activeIds.push(t.id),t.disabled=!0},subBtn:function(){var t=this,e=[];this.labelList.map((function(t){t.label.map((function(t){0==t.disabled&&e.push(t.id)}))})),Object(I["W"])(this.uid,{label_ids:this.activeIds,un_label_ids:e}).then((function(e){t.$Message.success(e.msg),t.$emit("editLabel")})).catch((function(e){t.$Message.error(e.msg)}))},cancel:function(){this.$emit("close")}}},Q=K,X=(s("2195"),Object(h["a"])(Q,Y,J,!1,null,"dc82e9ea",null)),Z=X.exports,tt=s("0fc4");function et(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var st={name:"rightMenu",components:{delivery:A,remarks:q,userLabel:Z,empty:w["a"]},props:{isTourist:{type:String|Number,default:0},status:{type:String|Number,default:""},uid:{type:String|Number,default:""},webType:{type:String|Number,default:""},exportOpen:{type:String,default:"0"}},filters:{statusFilters:function(t){var e=et({"-1":"申请退款","-2":"退货成功",0:"待发货",1:"待收货",2:"已收货",3:"待评价"},"-1","已退款");return e[t]},getDay:function(t){if(t)return k.a.unix(t).format("YYYY年M月D日")},typeFilters:function(t){var e={h5:"H5",wechat:"公众号",routine:"小程序",pc:"PC"};return e[t]}},data:function(){return{openErp:!1,userGroup:[],model1:"",curMenuIndex:0,menuList:[{key:"",title:"全部"},{key:0,title:"未支付"},{key:1,title:"未发货"},{key:-1,title:"退款中"}],activeUserInfo:"",curStatus:this.status,limit:10,orderConfig:{page:1,type:"",searchTxt:""},orderList:[],isOrderScroll:!0,isOrderHidden:!0,isDelivery:!1,isRemarks:!1,goodsTab:[{key:0,title:"购买"},{key:1,title:"足迹"},{key:2,title:"热销"}],goodsConfig:{type:0,buyList:[]},isUserLabel:!1,remarkId:"",itemId:0,remarkTitle:"",orderId:"",orderType:"",storeName:""}},watch:{uid:function(t,e){t!=e&&0==this.isTourist&&t?(this.orderConfig.page=1,this.isOrderScroll=!0,this.orderList=[],Promise.all[(this.getUserInfo(),this.getOrderList(),this.productCart(),this.getUserGroup())],0==this.goodsConfig.type?this.productCart():1==this.goodsConfig.type?this.productVisit():this.productHot()):(this.orderConfig.page=1,this.isOrderScroll=!0,this.orderList=[],this.activeUserInfo="")},isTourist:function(t,e){1==t&&(this.activeUserInfo="",this.orderList=[],this.goodsConfig.buyList=[])}},mounted:function(){var t=this;this.getErpConfig(),this.bus.$on("selectRightMenu",(function(e){t.curStatus=e})),this.uid&&0==this.isTourist&&Promise.all[(this.getUserInfo(),this.getOrderList(),this.productCart(),this.getUserGroup())]},methods:{getErpConfig:function(){var t=this;Object(tt["a"])().then((function(e){t.openErp=e.data.open_erp})).catch((function(e){t.$Message.error(e.msg)}))},onChange:function(t){var e=this;t&&Object(I["E"])(this.uid,t).then((function(t){e.$Message.success(t.msg)}))},getUserGroup:function(){var t=this;Object(I["T"])().then((function(e){t.userGroup=e.data}))},openDelivery:function(t){if(t.refund.length)return this.$Message.warning("存在售后待处理订单");this.$store.commit("admin/order/setSplitOrder",t.total_num),this.orderId=t.id,this.orderType=t._status._type,this.isDelivery=!0},deliveryOk:function(){this.orderConfig.page=1,this.isOrderScroll=!0,this.orderList=[],this.getOrderList(),this.isDelivery=!1},bindRemark:function(t){console.log(t.id),this.remarkTitle=t.remark,this.remarkId=t.order_id,this.itemId=t.id,this.isRemarks=!0},remarkSuccess:function(){this.remarkId="",this.isRemarks=!1,this.orderConfig.page=1,this.orderList=[],this.isOrderScroll=!0,this.getOrderList()},getUserInfo:function(){var t=this;Object(I["U"])(this.uid).then((function(e){t.activeUserInfo=e.data})).catch((function(e){t.activeUserInfo=""}))},getOrderList:function(){var t=this;this.isOrderScroll&&Object(I["o"])(this.uid,{page:this.orderConfig.page,limit:this.limit,type:this.orderConfig.type,search:this.orderConfig.searchTxt}).then((function(e){t.orderConfig.page+=1,t.isOrderScroll=e.data.length>=t.limit,t.orderList=t.orderList.concat(e.data)}))},bindTab:function(t){this.orderConfig.type!==t.key&&(this.orderConfig.type=t.key,this.uid&&(this.orderConfig.page=1,this.isOrderScroll=!0,this.orderList=[],this.getOrderList()))},orderSearch:function(){this.isOrderScroll=!0,this.orderList=[],this.orderConfig.page=1,this.getOrderList()},deliveryClose:function(){this.isUserLabel=!1,this.isDelivery=!1,this.isRemarks=!1},orderEdit:function(t){var e=this;this.$modalForm(Object(I["s"])(t)).then((function(){return e.getOrderList()}))},orderRecord:function(t){var e=this;this.$modalForm((-1==this.orderConfig.type?I["l"]:I["v"])(t)).then((function(){e.orderList=[],e.orderConfig.page=1,e.getOrderList()}))},orderReachBottom:function(){this.getOrderList()},bindGoodsTab:function(t){this.goodsConfig.type!=t.key&&(this.goodsConfig.type=t.key,""!=this.uid&&(0==t.key?this.productCart():1==t.key?this.productVisit():this.productHot()))},productCart:function(){var t=this;Object(I["A"])(this.uid,{store_name:this.storeName}).then((function(e){t.goodsConfig.buyList=e.data}))},productVisit:function(){var t=this;Object(I["D"])(this.uid,{store_name:this.storeName}).then((function(e){t.goodsConfig.buyList=e.data}))},productHot:function(){var t=this;Object(I["B"])(this.uid,{store_name:this.storeName}).then((function(e){t.goodsConfig.buyList=e.data}))},editLabel:function(){this.isUserLabel=!1,this.getUserInfo()},pushGoods:function(t){this.$emit("bindPush",t.id)},productSearch:function(){0==this.goodsConfig.type?this.productCart():1==this.goodsConfig.type?this.productVisit():this.productHot()}}},it=st,at=(s("c984"),Object(h["a"])(it,T,$,!1,null,"5d40579c",null)),nt=at.exports,rt=s("7624"),ot=s("c276"),ct=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"msg-box"},[s("div",{staticClass:"head"},[s("div",{staticClass:"tab-bar"},t._l(t.tabList,(function(e,i){return s("a",{key:i,staticClass:"tab-item",class:{on:e.key==t.tabCur},attrs:{href:"javascript:;"},on:{click:function(s){return t.bindTab(e)}}},[t._v(t._s(e.title))])})),0),s("div",{staticClass:"search-box"},[s("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"搜索快捷回复"},on:{"on-enter":t.bindSearch},model:{value:t.searchTxt,callback:function(e){t.searchTxt=e},expression:"searchTxt"}},[s("Icon",{attrs:{slot:"suffix",type:"ios-search"},slot:"suffix"})],1)],1)]),s("div",{staticClass:"main"},[s("div",{staticClass:"left-box"},[s("vue-scroll",{attrs:{ops:t.ops}},[t.tabCur?s("div",{staticClass:"left-item"},[s("p",[t._v("分组")]),s("span",{staticClass:"iconfont iconaddto",on:{click:t.openAddSort}})]):t._e(),t._l(t.sortList,(function(e,i){return s("div",{key:i,staticClass:"left-item",class:{on:t.cateId==e.id},on:{click:function(s){return t.selectSort(e)}}},[s("p",[t._v(t._s(e.name))]),t.tabCur?[s("span",{staticClass:"iconfont iconDot",on:{click:function(s){return!s.type.indexOf("key")&&t._k(s.keyCode,"top",void 0,s.key,void 0)?null:t.bindEdit(e,i)}}}),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isEdit,expression:"item.isEdit"}],staticClass:"edit-wrapper"},[s("div",{staticClass:"edit-item",on:{click:function(s){return t.editSort(e)}}},[t._v("编辑")]),s("div",{staticClass:"edit-item",on:{click:function(s){return t.delSort(e,"删除分类",i)}}},[t._v("\n                删除\n              ")])]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isEdit,expression:"item.isEdit"}],staticClass:"edit-bg",on:{click:function(t){t.stopPropagation(),e.isEdit=!1}}})]:t._e()],2)}))],2)],1),s("div",{staticClass:"right-box"},[s("Scroll",{staticClass:"right-scroll",attrs:{"on-reach-bottom":t.handleReachBottom,height:"360"}},[t.tabCur?s("div",{staticClass:"msg-item add-box",staticStyle:{"margin-top":"0"}},[s("div",{staticClass:"box2"},[s("Input",{staticClass:"input-box",staticStyle:{width:"100%"},attrs:{placeholder:"输入标题（选填）"},on:{"on-focus":t.bindFocus},model:{value:t.addMsg.title,callback:function(e){t.$set(t.addMsg,"title",e)},expression:"addMsg.title"}}),s("div",{staticClass:"conBox",class:{active:t.addMsg.isEdit}},[s("div",{staticClass:"content"},[s("Input",{attrs:{type:"textarea",rows:4,placeholder:"请输入内容"},model:{value:t.addMsg.message,callback:function(e){t.$set(t.addMsg,"message",e)},expression:"addMsg.message"}})],1),s("div",{staticClass:"bom"},[s("div",{staticClass:"select"},[s("Select",{staticStyle:{width:"100px"},attrs:{size:"small"},model:{value:t.addMsg.cateId,callback:function(e){t.$set(t.addMsg,"cateId",e)},expression:"addMsg.cateId"}},t._l(t.sortList,(function(e){return s("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name)+"\n                    ")])})),1)],1),s("div",{staticClass:"btns-box"},[s("Button",{on:{click:function(e){e.stopPropagation(),t.addMsg.isEdit=!1}}},[t._v("取消")]),s("Button",{attrs:{type:"primary"},on:{click:function(e){return e.stopPropagation(),t.bindAdd(e)}}},[t._v("保存")])],1)])])],1)]):t._e(),t._l(t.list,(function(e,i){return e.id?s("div",{key:i,staticClass:"msg-item"},[e.isEdit?s("div",{staticClass:"box2"},[s("Input",{staticClass:"input-box",staticStyle:{width:"100%"},attrs:{placeholder:"输入标题（选填）"},model:{value:e.title,callback:function(s){t.$set(e,"title",s)},expression:"item.title"}}),s("div",{staticClass:"content"},[s("Input",{attrs:{type:"textarea",rows:4,placeholder:"请输入内容"},model:{value:e.message,callback:function(s){t.$set(e,"message",s)},expression:"item.message"}})],1),s("div",{staticClass:"bom"},[s("div",{staticClass:"select"},[s("Select",{staticStyle:{width:"100px"},attrs:{size:"small"},model:{value:t.cateId,callback:function(e){t.cateId=e},expression:"cateId"}},t._l(t.sortList,(function(e){return s("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name)+"\n                  ")])})),1)],1),s("div",{staticClass:"btns-box"},[s("Button",{on:{click:function(s){return s.stopPropagation(),t.editClose(e)}}},[t._v("取消")]),s("Button",{attrs:{type:"primary"},on:{click:function(s){return s.stopPropagation(),t.updataMsg(e)}}},[t._v("保存")])],1)])],1):s("div",{staticClass:"box1"},[s("div",{staticClass:"txt-box",on:{click:function(s){return t.bindRadio(e)}}},[e.title?s("span",{staticClass:"title"},[t._v(t._s(t._f("filtersTitle")(e.title)))]):t._e(),e.message?s("span",[t._v(t._s(t._f("filtersCon")(e.message)))]):t._e()]),t.tabCur?s("div",{staticClass:"edit-box"},[s("span",{staticClass:"iconfont iconbianji",on:{click:function(s){return s.stopPropagation(),t.editMsg(e)}}}),s("span",{staticClass:"iconfont iconshanchu",on:{click:function(s){return s.stopPropagation(),t.delMsg(e,"删除话术",i)}}})]):t._e()])]):t._e()}))],2)],1)]),s("Modal",{staticClass:"class-box",attrs:{title:t.maskTitle,width:"304",mask:!1,"footer-hide":!0},model:{value:t.isAddSort,callback:function(e){t.isAddSort=e},expression:"isAddSort"}},[s("div",{staticClass:"item"},[s("span",[t._v("分组名称：")]),s("Input",{attrs:{placeholder:"分组名称"},model:{value:t.classTitle,callback:function(e){t.classTitle=e},expression:"classTitle"}})],1),s("div",{staticClass:"item"},[s("span",[t._v("分组排序：")]),s("Input",{attrs:{placeholder:"输入排序"},model:{value:t.classSort,callback:function(e){t.classSort=e},expression:"classSort"}})],1),s("div",{staticClass:"btn"},[s("Button",{staticStyle:{background:"#1890ff",width:"100%"},attrs:{type:"primary"},on:{click:t.addServiceCate}},[t._v("确定")])],1)])],1)},lt=[],dt={name:"msgWindow",data:function(){return{ops:{vuescroll:{mode:"native",enable:!1,tips:{deactive:"Push to Load",active:"Release to Load",start:"Loading...",beforeDeactive:"Load Successfully!"},auto:!1,autoLoadDistance:0,pullRefresh:{enable:!1},pushLoad:{enable:!1,auto:!0,autoLoadDistance:10}},bar:{background:"#393232",opacity:".5",size:"2px"}},isScroll:!0,page:1,limit:10,tabCur:1,tabList:[{title:"个人库",key:1},{title:"公共库",key:0}],searchTxt:"",list:[{isEdit:!1}],model1:"",msgTitle:"",sortList:[],cateId:"",addMsg:{title:"",message:"",cateId:"",isEdit:!1},isAddSort:!1,classTitle:"",classSort:"",maskTitle:"",editObj:{},isSearchType:!1,oldTitle:"",oldMsg:""}},filters:{filtersTitle:function(t){var e=37;if(t.length>e){var s=t.substring(0,e);return"".concat(s,"...")}return t},filtersCon:function(t){var e=113;if(t.length>e){var s=t.substring(0,e);return"".concat(s,"...")}return t}},mounted:function(){var t=this;this.serviceCate(),this.$nextTick((function(){t.scroll=new BScroll(t.$refs.wrapper,{mouseWheel:{speed:20,invert:!1,easeTime:300},scrollbar:!0,disableMouse:!0})}))},methods:{editClose:function(t){this.oldTitle&&this.oldMsg&&(t.title=this.oldTitle,t.message=this.oldMsg),t.isEdit=!1},editMsg:function(t){this.oldTitle=JSON.parse(JSON.stringify(t.title)),this.oldMsg=JSON.parse(JSON.stringify(t.message)),t.isEdit=!0,this.cateId=t.cate_id},bindEdit:function(t,e){0!=e&&(t.isEdit=!t.isEdit)},bindTab:function(t){this.tabCur=t.key,this.cateId="",this.sortList=[],this.isScroll=!0,this.page=1,this.list=[],this.serviceCate()},bindSearch:function(){this.isSearchType||(this.isScroll=!0,this.page=1,this.list=[],this.getList(),this.isSearchType=!0)},selectSort:function(t){this.cateId!=t.id&&(this.sortList.forEach((function(e,s){e.id!=t.id&&(e.isEdit=!1)})),this.cateId=t.id,this.isScroll=!0,this.page=1,this.list=[],this.getList())},delSort:function(t,e,s){var i=this,a={title:e,num:s,url:"/service/cate/".concat(t.id),method:"DELETE",ids:"",kefu:!0};this.$modalSure(a).then((function(t){i.$Message.success(t.msg),i.isScroll=!0,i.page=1,i.list=[],i.cateId="",i.serviceCate()})).catch((function(t){i.$Message.error(t.msg)}))},serviceCate:function(){var t=this;Object(I["K"])({type:this.tabCur}).then((function(e){var s={id:"",name:"全部"};e.data.data.forEach((function(t,e){t.isEdit=!1})),e.data.data.unshift(s),t.sortList=e.data.data,""===t.cateId&&(t.cateId=e.data.data[0].id),t.getList()}))},getList:function(){var t=this;this.isScroll&&Object(I["P"])({page:this.page,limit:this.limit,title:this.searchTxt,cate_id:this.cateId,type:this.tabCur}).then((function(e){t.isScroll=e.data.length>=t.limit,e.data.forEach((function(t,e){t.isEdit=!1})),t.page++,t.list=t.list.concat(e.data),t.isSearchType=!1})).catch((function(e){t.isSearchType=!1}))},updataMsg:function(t){var e=this;Object(I["L"])(t.id,{title:t.title,cate_id:this.cateId,message:t.message}).then((function(s){e.$Message.success("修改成功"),t.isEdit=!1})).catch((function(s){e.$Message.error(s.msg),t.isEdit=!0}))},bindFocus:function(){this.list.forEach((function(t,e){t.isEdit=!1})),this.addMsg.isEdit=!0},openAddSort:function(){console.log("tianj"),this.editObj.id="",this.isAddSort=!0,this.maskTitle="添加分组"},bindAdd:function(){var t=this;Object(I["d"])({title:this.addMsg.title,cate_id:this.addMsg.cateId,message:this.addMsg.message}).then((function(e){t.addMsg.title="",t.addMsg.message="",t.addMsg.cateId="",t.addMsg.isEdit=!1,t.$Message.success(e.msg),e.data.isEdit=!1,t.page=1,t.list=[],t.isScroll=!0,t.serviceCate()})).catch((function(e){t.$Message.error(e.msg)}))},delMsg:function(t,e,s,i){var a=this,n={title:e,num:s,url:"service/speechcraft/".concat(t.id),method:"DELETE",ids:"",kefu:!0};this.$modalSure(n).then((function(t){a.$Message.success(t.msg),a.list.splice(s,1)})).catch((function(t){a.$Message.error(t.msg)}))},addServiceCate:function(){var t=this;this.editObj.id?Object(I["g"])(this.editObj.id,{name:this.classTitle,sort:this.classSort}).then((function(e){t.classTitle="",t.classSort="",t.$Message.success(e.msg),t.isAddSort=!1,t.page=1,t.list=[],t.isScroll=!0,t.serviceCate()})).catch((function(e){t.classTitle="",t.classSort="",t.$Message.error(res.msg)})):Object(I["c"])({name:this.classTitle,sort:this.classSort}).then((function(e){t.classTitle="",t.classSort="",t.$Message.success(e.msg),t.isAddSort=!1,t.page=1,t.list=[],t.isScroll=!0,t.serviceCate()})).catch((function(e){t.classTitle="",t.classSort="",t.$Message.error(res.msg)}))},editSort:function(t){this.classSort=t.sort,this.classTitle=t.name,this.isAddSort=!0,this.maskTitle="编辑分组",this.editObj=t},handleReachBottom:function(){this.getList()},bindRadio:function(t){this.$emit("activeTxt",t.message)}}},ut=dt,ft=(s("647d"),s("6db9"),Object(h["a"])(ut,ct,lt,!1,null,"0ef7adb1",null)),mt=ft.exports,pt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"list-wrapper"},t._l(t.labelLists,(function(e,i){return s("div",{key:i,staticClass:"user-item",on:{click:function(s){return t.bindActive(e)}}},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.avatar,expression:"item.avatar"}],attrs:{alt:""}}),s("p",{staticClass:"line1"},[t._v(t._s(e.wx_name))])])})),0)])},ht=[],vt={name:"transfer",props:{userUid:{type:String|Number,default:""}},data:function(){return{loading:!1,currentChoose:"",labelLists:[],name:""}},mounted:function(){this.getList()},methods:{getList:function(){var t=this;Object(I["R"])({nickname:this.name,uid:this.userUid}).then((function(e){t.labelLists=e.data.list}))},bindActive:function(t){var e=this;if(""==this.userUid)return this.$Message.error("转接失败");Object(I["O"])({uid:this.userUid,kefuToUid:t.uid}).then((function(t){e.$Message.success(t.msg),e.$emit("close")})).catch((function(t){e.$Message.error(t.msg)}))}}},gt=vt,_t=(s("80e0"),Object(h["a"])(gt,pt,ht,!1,null,"0f96dabc",null)),bt=_t.exports,Ct=s("adde"),yt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.orderDetail.userInfo?s("div",{staticClass:"order_detail"},[0==t.orderDetail.product_type?s("div",{staticClass:"msg-box"},[s("div",{staticClass:"box-title"},[t._v("收货信息")]),s("div",{staticClass:"msg-wrapper"},[s("div",{staticClass:"msg-item"},[s("div",{staticClass:"item"},[s("span",[t._v("用户昵称：")]),t._v(t._s(t.orderDetail.userInfo.nickname)+"\n                    ")]),s("div",{staticClass:"item"},[s("span",[t._v("收货人：")]),t._v(t._s(t.orderDetail.orderInfo.real_name)+"\n                    ")])]),s("div",{staticClass:"msg-item"},[s("div",{staticClass:"item"},[s("span",[t._v("联系电话：")]),t._v(t._s(t.orderDetail.orderInfo.user_phone)+"\n                    ")]),s("div",{staticClass:"item"},[s("span",[t._v("收货地址：")]),t._v(t._s(t.orderDetail.orderInfo.user_address)+"\n                    ")])])])]):t._e(),s("div",{staticClass:"msg-box"},[s("div",{staticClass:"box-title"},[t._v("订单信息")]),s("div",{staticClass:"msg-wrapper"},[s("div",{staticClass:"msg-item"},[s("div",{staticClass:"item"},[s("span",[t._v("订单ID：")]),t._v(t._s(t.orderDetail.orderInfo.order_id)+"\n                    ")]),s("div",{staticClass:"item",staticStyle:{color:"red"}},[s("span",{staticStyle:{color:"red"}},[t._v("订单状态：")]),t._v(t._s(t.orderDetail.orderInfo._status._title)+"\n                    ")])]),s("div",{staticClass:"msg-item"},[s("div",{staticClass:"item"},[s("span",[t._v("商品总数：")]),t._v(t._s(t.orderDetail.orderInfo.total_num)+"\n                    ")]),s("div",{staticClass:"item"},[s("span",[t._v("商品总价：")]),t._v(t._s((parseFloat(t.orderDetail.orderInfo.total_price)-parseFloat(t.orderDetail.orderInfo.vip_true_price)).toFixed(2))+"\n                    ")])]),s("div",{staticClass:"msg-item"},[s("div",{staticClass:"item"},[s("span",[t._v("交付邮费：")]),t._v(t._s(t.orderDetail.orderInfo.pay_postage)+"\n                    ")]),s("div",{staticClass:"item"},[s("span",[t._v("优惠券金额：")]),t._v(t._s(t.orderDetail.orderInfo.coupon_price)+"\n                    ")])]),s("div",{staticClass:"msg-item"},[s("div",{staticClass:"item"},[s("span",[t._v("会员商品优惠：")]),t._v(t._s(t.orderDetail.orderInfo.vip_true_price||0)+"\n                    ")]),s("div",{staticClass:"item"},[s("span",[t._v("积分抵扣：")]),t._v(t._s(t.orderDetail.orderInfo.deduction_price||0)+"\n                    ")])]),s("div",{staticClass:"msg-item"},[s("div",{staticClass:"item"},[s("span",[t._v("实际支付：")]),t._v(t._s(t.orderDetail.orderInfo.pay_price)+"\n                    ")]),s("div",{staticClass:"item"},[s("span",[t._v("创建时间：")]),t._v(t._s(t.orderDetail.orderInfo.add_time)+"\n                    ")])]),s("div",{staticClass:"msg-item"},[s("div",{staticClass:"item"},[s("span",[t._v("支付方式：")]),t._v(t._s(t.orderDetail.orderInfo._status._payType)+"\n                    ")]),s("div",{staticClass:"item"},[s("span",[t._v("推广人：")]),t._v(t._s(t.orderDetail.userInfo.spread_name)+"\n                    ")])]),s("div",{staticClass:"msg-item"},[s("div",{staticClass:"item"},[s("span",[t._v("商家备注：")]),t._v(t._s(t.orderDetail.orderInfo.remark)+"\n                    ")]),s("div",{staticClass:"item acea-row"},[t.isReturen?s("span",[t._v("退款留言：")]):s("span",[t._v("买家备注：")]),s("div",{staticClass:"msgCon"},[t._v(t._s(t.orderDetail.orderInfo.mark))])])]),s("div",{staticClass:"msg-item"},[t.orderDetail.orderInfo.refund_goods_explain?s("div",{staticClass:"item acea-row"},[s("span",[t._v("退货留言：")]),s("div",{staticClass:"msgCon"},[t._v(t._s(t.orderDetail.orderInfo.refund_goods_explain))])]):t._e(),t.orderDetail.orderInfo.refund_img&&t.orderDetail.orderInfo.refund_img.length?s("div",{staticClass:"item"},[s("span",[t._v("退款凭证：")]),t._l(t.orderDetail.orderInfo.refund_img,(function(t,e){return s("div",{staticClass:"pictrue"},[s("img",{attrs:{src:t}})])}))],2):t._e()]),s("div",{staticClass:"msg-item"},["fictitious"==t.orderDetail.orderInfo.delivery_type&&t.orderDetail.orderInfo.fictitious_content&&1!=t.orderDetail.orderInfo.product_type?s("div",{staticClass:"item acea-row"},[s("span",[t._v("虚拟备注：")]),s("div",{staticClass:"msgCon"},[t._v(t._s(t.orderDetail.orderInfo.fictitious_content))])]):t._e(),t.orderDetail.orderInfo.virtual_info&&1==t.orderDetail.orderInfo.product_type?s("div",{staticClass:"item acea-row"},[s("span",[t._v("卡密发货：")]),s("div",{staticClass:"msgCon"},[t._v(t._s(t.orderDetail.orderInfo.virtual_info))])]):t._e()]),s("div",{staticClass:"msg-item"},[t.orderDetail.orderInfo.refund_goods_img&&t.orderDetail.orderInfo.refund_goods_img.length?s("div",{staticClass:"item"},[s("span",[t._v("退货凭证：")]),t._l(t.orderDetail.orderInfo.refund_goods_img,(function(t,e){return s("div",{staticClass:"pictrue"},[s("img",{attrs:{src:t}})])}))],2):t._e()])])]),t.orderDetail.orderInfo.promotions_detail&&t.orderDetail.orderInfo.promotions_detail.length?s("div",{staticClass:"msg-box"},[s("div",{staticClass:"box-title"},[t._v("优惠活动")]),s("div",{staticClass:"msg-wrapper"},[s("div",{staticClass:"msg-item"},t._l(t.orderDetail.orderInfo.promotions_detail,(function(e,i){return s("div",{staticClass:"item"},[s("span",[t._v(t._s(e.title)+"：")]),t._v("-￥"+t._s(parseFloat(e.promotions_price).toFixed(2))+"\n\t\t        \t")])})),0)])]):t._e(),t.orderDetail.orderInfo.custom_form&&t.orderDetail.orderInfo.custom_form.length?s("div",{staticClass:"msg-box",staticStyle:{border:"none"}},[s("div",{staticClass:"box-title"},[t._v("自定义留言")]),s("div",{staticClass:"msg-wrapper"},t._l(t.customForm,(function(e,i){return s("div",{key:i,staticClass:"msg-item"},t._l(e.list,(function(e,i){return s("div",{key:i,staticClass:"item acea-row"},[s("span",[t._v(t._s(e.title)+"：")]),"img"!=e.label?s("div",{staticClass:"msgCon"},[t._v(t._s(e.value||"暂无"))]):t._e(),t._l(e.value,(function(i,a){return"img"==e.label?s("div",{key:a,staticClass:"pictrue"},[s("img",{attrs:{src:i}})]):t._e()}))],2)})),0)})),0)]):t._e(),s("div",{staticClass:"goods-box"},[s("Table",{attrs:{columns:t.columns1,data:t.orderList},scopedSlots:t._u([{key:"id",fn:function(e){var s=e.row;e.index;return[t._v("\n                    "+t._s(s.productInfo.id)+"\n                ")]}},{key:"name",fn:function(e){var i=e.row;e.index;return[s("div",{staticClass:"product_info"},[s("img",{attrs:{src:i.productInfo.image,alt:""}}),s("p",[i.is_gift?s("span",{staticClass:"font-color-red"},[t._v("[赠品]")]):t._e(),t._v(t._s(i.productInfo.store_name))])])]}},{key:"className",fn:function(e){var s=e.row;e.index;return[t._v("\n                    "+t._s(s.class_name)+"\n                ")]}},{key:"price",fn:function(e){var s=e.row;e.index;return[t._v("\n                    "+t._s(s.productInfo.attrInfo.price)+"\n                ")]}},{key:"total_num",fn:function(e){var s=e.row;e.index;return[t._v("\n                    "+t._s(s.cart_num)+"\n                ")]}}],null,!1,1509557130)})],1)]):t._e()},kt=[],It={name:"order_detail",props:{orderId:{type:String|Number,default:""},isReturen:{type:Boolean,default:!1}},data:function(){return{orderDetail:{},orderList:[],columns1:[{title:"商品ID",slot:"id",maxWidth:80},{title:"商品名称",slot:"name",minWidth:160},{title:"商品分类",slot:"className"},{title:"商品售价",slot:"price"},{title:"商品数量",slot:"total_num"}],customForm:[]}},mounted:function(){this.getOrderInfo()},methods:{getOrderInfo:function(){var t=this;(this.isReturen?Object(I["H"])(this.orderId):Object(I["u"])(this.orderId)).then((function(e){e.data.orderInfo.add_time=t.$moment(1e3*parseInt(e.data.orderInfo.add_time)).format("YYYY-MM-DD"),t.orderDetail=e.data,t.orderList=e.data.orderInfo.cartInfo;for(var s=e.data.orderInfo.custom_form,i=Math.ceil(s.length/2),a=new Array,n=0;n<i;n++){var r=s.slice(2*n,2*n+2);r.length&&a.push({list:r})}t.customForm=a}))}}},wt=It,St=(s("cd3a"),Object(h["a"])(wt,yt,kt,!1,null,"6cb3de84",null)),xt=St.exports,Ot=s("7a1a");function Lt(t){return jt(t)||$t(t)||Tt()}function Tt(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function $t(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function jt(t){if(Array.isArray(t)){for(var e=0,s=new Array(t.length);e<t.length;e++)s[e]=t[e];return s}}function Dt(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function Mt(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?Dt(s,!0).forEach((function(e){Vt(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Dt(s).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function Vt(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var Pt=s("16b0"),Et=new Audio(Pt),Nt=function(t,e){e=1*e||1;var s=[];return t.forEach((function(t,i){i%e===0&&s.push([]),s[s.length-1].push(t)})),s},Ut={name:"index",components:{baseHeader:g,chatList:L,rightMenu:nt,msgWindow:mt,transfer:bt,HappyScroll:r["HappyScroll"],goodsDetail:Ct["a"],orderDetail:xt},directives:{paste:{bind:function(t,e,s){t.addEventListener("paste",(function(t){e.value(t)}))}}},data:function(){return{isEmoji:!1,chatCon:"",emojiGroup:Nt(rt["a"],20),emojiList:rt["a"],html:"",userActive:{},kefuInfo:{},isMsg:!1,isTransfer:!1,activeMsg:"",chatList:[],text:"",limit:20,upperId:0,online:!0,scrollTop:0,isScroll:!0,oldHeight:0,isLoad:!1,isProductBox:!1,goodsId:"",isOrder:!1,orderId:"",upload:"",header:{},uploadData:{filename:"file"},userOnline:{},newRecored:{},searchData:"",scrollNum:0,transferId:"",bodyClose:!1,tourist:0,touristLen:0,pageWs:"",isShow:!1,isReturen:!1,toChat:!1}},computed:Mt({},Object(l["e"])({socketStatus:function(t){return t.admin.kefu.socketStatus}}),{disabled:function(){return 0==this.chatCon.length},records:function(){var t=this;return this.chatList.map((function(e,s){return e.time=t.$moment(1e3*e.add_time).format("MMMDo H:mm"),s?e.add_time-t.chatList[s-1].add_time>=300?e.show=!0:e.show=!1:e.show=!0,e}))}}),watch:{},created:function(){var t=this;this.upload=n["a"].apiBaseURL.replace("adminapi","kefuapi")+"/upload",Object(Ot["a"])().then((function(e){t.kefuInfo=e.data,t.kefuInfo.site_name?document.title=t.kefuInfo.site_name:t.kefuInfo.site_name=""}))},mounted:function(){var t=this;window.addEventListener("click",(function(){t.isEmoji=!1})),this.bus.pageWs=Object(C["a"])(!0,ot["a"].cookies.kefuGet("token")),this.wsAgain(),this.header["Authori-zation"]="Bearer "+ot["a"].cookies.kefuGet("token"),this.text=this.replace_em("[em-smiling_imp]")},methods:{wsAgain:function(){var t=this;this.bus.pageWs.then((function(e){e.$on(["reply","chat"],(function(e){1==e.msn_type&&(e.msn=t.replace_em(e.msn)),2==e.msn_type&&-1==e.msn.indexOf("[")&&(e.msn=t.replace_em("[".concat(e.msn,"]"))),t.chatList.push(e),t.$nextTick((function(){this.scrollTop=document.querySelector("#chat_scroll").offsetHeight}))})),e.$on("reply",(function(t){})),e.$on("socket_error",(function(){t.$Message.error("连接失败")})),e.$on("err_tip",(function(e){t.$Message.error(e.msg)})),e.$on("user_online",(function(e){t.userOnline=e})),e.$on("mssage_num",(function(e){e.num>0&&Et.play(),t.chatList.forEach((function(t){t.to_uid==e.uid&&(t.mssage_num=e.num)})),e.recored.id&&(t.newRecored=e.recored)})),e.$on("timeout",(function(e){t.isShow=!1,t.wsRestart()})),e.$on("close",(function(){t.toChat=!1,t.isShow=!1})),e.$on("success",(function(s){t.isShow=!0,!t.toChat&&t.userActive.to_uid&&e.send({data:{id:t.userActive.to_uid},type:"to_chat"})}))})).catch((function(e){t.wsRestart()}))},handleParse:function(t){console.log(t);var e=null;t.clipboardData&&t.clipboardData.items[0]&&t.clipboardData.items[0].type&&t.clipboardData.items[0].type.indexOf("image")>-1?(e=t.clipboardData.items[0].getAsFile(),this.update(e)):this.$message({type:"warning",message:"上传的文件必须为图片且无法复制本地图片且无法同时复制多张图片"})},update:function(t){var e=this,s=t,i=new FormData;i.append("filename","file"),i.append("file",s),Object(I["S"])(i).then((function(t){console.log(t),e.sendMsg(t.data.url,3)}))},beforeUpload:function(){},wsRestart:function(){this.bus.pageWs||(this.bus.pageWs=Object(C["a"])(!0),this.wsAgain())},handleFormatError:function(t){this.$Message.error("上传图片只能是 jpg、jpg、jpeg、gif 格式!")},bindEnter:function(t){if(""==t.target.value)return this.$Message.error("请输入消息");this.sendMsg(t.target.value,1),this.chatCon=""},handleSuccess:function(t,e,s){200===t.status?(this.$Message.success(t.msg),this.sendMsg(t.data.url,3)):this.$Message.error(t.msg)},lookOrder:function(t){this.isReturen=7==t.msn_type,this.orderId=t.orderInfo.id,console.log("khjh",this.orderId),this.isOrder=!0},setOnline:function(t){this.bus.pageWs.then((function(e){e.send({data:{online:t},type:"online"})})),this.online=t},listen:function(t){if(13==t.keyCode)return t.preventDefault(),!1},select:function(t){var e="[".concat(t,"]");this.chatCon+=e,this.isEmoji=!1},replace_em:function(t){return t=t.replace(/\[em-([a-z_]*)\]/g,"<span class='em em-$1'/></span>"),t},changeLen:function(t){this.touristLen=t},changeType:function(t){this.tourist=t},setDataId:function(t){var e=this;this.userActive=t,this.toChat=!1,this.chatList=[],this.upperId=0,this.oldHeight=0,this.isScroll=!0,t?(window.document.title=t.nickname?"正在和".concat(t.nickname,"对话中 - ").concat(this.kefuInfo.site_name):"正在和游客对话中 - "+this.kefuInfo.site_name,this.isShow&&this.bus.pageWs.then((function(t){t.send({data:{id:e.userActive.to_uid},type:"to_chat"}),e.toChat=!0})),this.getChatList(),this.$refs.textBox.focus()):window.document.title=this.kefuInfo.site_name},msgClose:function(){this.isTransfer=!1},activeTxt:function(t){this.chatCon=t,this.isMsg=!1},sendText:function(){this.sendMsg(this.chatCon,1),this.chatCon=""},sendMsg:function(t,e){var s={type:"chat",data:{msn:t,type:e,to_uid:this.userActive.to_uid,is_tourist:this.tourist}};this.bus.pageWs.then((function(t){t.send(s)}))},send:function(t,e){C["a"].send({data:e,type:t})},getChatList:function(){var t=this;Object(I["M"])({limit:this.limit,uid:this.userActive.to_uid,upperId:this.upperId,is_tourist:this.tourist}).then((function(e){e.data.forEach((function(e){1==e.msn_type?e.msn=t.replace_em(e.msn):2==e.msn_type&&(e.msn=t.replace_em("[".concat(e.msn,"]")))}));var s="";s=0==t.upperId?"":"chat_".concat(t.chatList[0].id),t.chatList=[].concat(Lt(e.data),Lt(t.chatList)),t.upperId=e.data.length>0?e.data[0].id:0,t.isLoad=!1,t.$nextTick((function(){t.isScroll=e.data.length>=t.limit,t.setPageScrollTo(s)}))}))},setPageScrollTo:function(t){var e=this;this.$nextTick((function(){if(t)setTimeout((function(){var s=parseFloat(document.getElementById(t).offsetTop)-60;e.scrollTop=s}),0);else{var s=document.querySelector("#chat_scroll");e.scrollTop=s.offsetHeight,setTimeout((function(t){e.scrollTop!=e.$refs.scrollBox.offsetHeight&&(e.scrollTop=document.querySelector("#chat_scroll").offsetHeight)}),300)}}))},scrollHandler:function(){this.isScroll&&this.upperId&&(this.isLoad=!0,this.getChatList())},scrollToTop:function(t){var e=this,s=document.querySelector("#chat_scroll");this.scrollTop=s.offsetHeight-this.oldHeight,setTimeout((function(t){e.scrollTop=e.$refs.scrollBox.offsetHeight-e.oldHeight}),300)},bindPush:function(t){this.sendMsg(t,5)},lookGoods:function(t){this.goodsId=t.msn,this.isProductBox=!0},bindSearch:function(t){this.searchData=t,this.oldHeight=0,this.upperId=0,this.isScroll=!1},transferPeople:function(t){this.transferId=t.id,this.isTransfer=!1,this.$Message.success("转接成功"),this.bus.pageWs.then((function(e){e.send({type:"to_chat",data:{id:t.uid}})}))},transferOk:function(){}}},Rt=Ut,At=(s("7f61"),Object(h["a"])(Rt,i,a,!1,null,"de2f65b8",null));e["default"]=At.exports},4112:function(t,e,s){t.exports=s.p+"view_admin/img/no_user.a09b282b.png"},"468b":function(t,e,s){t.exports=s.p+"view_admin/img/no_all.174e30c0.png"},"4e4b":function(t,e,s){"use strict";var i=s("8672"),a=s.n(i);a.a},5022:function(t,e,s){},"576a":function(t,e,s){},"5f70":function(t,e,s){t.exports=s.p+"view_admin/img/no_fh.977a0fb8.png"},"631e":function(t,e,s){},"647d":function(t,e,s){"use strict";var i=s("db8e"),a=s.n(i);a.a},"6d31":function(t,e,s){},"6db9":function(t,e,s){"use strict";var i=s("576a"),a=s.n(i);a.a},7624:function(t,e,s){"use strict";e["a"]=["em-smile","em-laughing","em-blush","em-smiley","em-relaxed","em-smirk","em-heart_eyes","em-kissing_heart","em-kissing_closed_eyes","em-flushed","em-relieved","em-satisfied","em-grin","em-wink","em-stuck_out_tongue_winking_eye","em-stuck_out_tongue_closed_eyes","em-grinning","em-kissing","em-kissing_smiling_eyes","em-stuck_out_tongue","em-sleeping","em-worried","em-frowning","em-anguished","em-open_mouth","em-grimacing","em-confused","em-hushed","em-expressionless","em-unamused","em-sweat_smile","em-sweat","em-disappointed_relieved","em-weary","em-pensive","em-disappointed","em-confounded","em-fearful","em-cold_sweat","em-persevere","em-cry","em-sob","em-joy","em-astonished","em-scream","em-tired_face","em-angry","em-rage","em-triumph","em-sleepy","em-yum","em-mask","em-sunglasses","em-dizzy_face","em-imp","em-smiling_imp","em-neutral_face","em-no_mouth","em-innocent","em-alien"]},"7a1a":function(t,e,s){"use strict";s.d(e,"a",(function(){return a}));var i=s("b6bd");function a(){return Object(i["a"])({url:"service/info",method:"get",kefu:!0})}},"7f61":function(t,e,s){"use strict";var i=s("0e03"),a=s.n(i);a.a},"80e0":function(t,e,s){"use strict";var i=s("eb11"),a=s.n(i);a.a},8672:function(t,e,s){},"8b1f":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"empty-wrapper"},[1==t.status?[i("img",{attrs:{src:s("011a"),alt:""}})]:t._e(),2==t.status?[i("img",{attrs:{src:s("4112"),alt:""}})]:t._e(),3==t.status?[i("img",{attrs:{src:s("468b"),alt:""}})]:t._e(),4==t.status?[i("img",{attrs:{src:s("ea87"),alt:""}})]:t._e(),5==t.status?[i("img",{attrs:{src:s("5f70"),alt:""}})]:t._e(),6==t.status?[i("img",{attrs:{src:s("060a"),alt:""}})]:t._e(),i("p",[t._v(t._s(t.msg))])],2)},a=[],n={name:"empty",props:{status:{type:String|Number,default:1},msg:{type:String,default:""}}},r=n,o=(s("e7bb"),s("2877")),c=Object(o["a"])(r,i,a,!1,null,"7fdc5215",null);e["a"]=c.exports},"9af2":function(t,e,s){},a407:function(t,e,s){},a7e1:function(t,e,s){"use strict";var i=s("6d31"),a=s.n(i);a.a},bafc:function(t,e,s){},bc93:function(t,e,s){},c1bb:function(t,e,s){"use strict";var i=s("9af2"),a=s.n(i);a.a},c984:function(t,e,s){"use strict";var i=s("631e"),a=s.n(i);a.a},cd3a:function(t,e,s){"use strict";var i=s("5022"),a=s.n(i);a.a},db8e:function(t,e,s){},e228:function(t,e,s){"use strict";var i=s("bc93"),a=s.n(i);a.a},e7bb:function(t,e,s){"use strict";var i=s("bafc"),a=s.n(i);a.a},ea87:function(t,e,s){t.exports=s.p+"view_admin/img/no_zf.e61fe9b5.png"},eb11:function(t,e,s){}}]);