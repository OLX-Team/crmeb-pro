(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/users/visit_list/index"],{"498a":function(t,i,e){"use strict";var n=e("899b"),s=e.n(n);s.a},"6da1":function(t,i,e){"use strict";(function(t){e("22b3");n(e("66fd"));var i=n(e("9574"));function n(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=e,t(i.default)}).call(this,e("543d")["createPage"])},"899b":function(t,i,e){},"8c83":function(t,i,e){"use strict";var n;e.d(i,"b",(function(){return s})),e.d(i,"c",(function(){return o})),e.d(i,"a",(function(){return n}));var s=function(){var t=this,i=t.$createElement,e=(t._self._c,t.visitList.length?t.__map(t.visitList,(function(i,e){var n=t.__get_orig(i),s=t.__map(i.picList,(function(i,e){var n=t.__get_orig(i),s=t.isShowChecked?i.id.toString():null;return{$orig:n,g0:s}}));return{$orig:n,l0:s}})):null);t.$mp.data=Object.assign({},{$root:{l1:e}})},o=[]},9574:function(t,i,e){"use strict";e.r(i);var n=e("8c83"),s=e("db87");for(var o in s)"default"!==o&&function(t){e.d(i,t,(function(){return s[t]}))}(o);e("498a");var c,l=e("f0c5"),a=Object(l["a"])(s["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],c);i["default"]=a.exports},ac80:function(t,i,e){"use strict";(function(t){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=e("16a8"),s=e("26cb"),o=e("fa9e"),c=l(e("d0ca"));function l(t){return t&&t.__esModule?t:{default:t}}var a=function(){Promise.all([e.e("common/vendor"),e.e("components/recommend/index")]).then(function(){return resolve(e("34f7"))}.bind(null,e)).catch(e.oe)},u=function(){e.e("components/Authorize").then(function(){return resolve(e("1702"))}.bind(null,e)).catch(e.oe)},h=function(){Promise.all([e.e("common/vendor"),e.e("components/home/index")]).then(function(){return resolve(e("f176"))}.bind(null,e)).catch(e.oe)},r={components:{recommend:a,authorize:u,home:h},mixins:[c.default],data:function(){return{isShowChecked:0,count:0,times:[],isAllSelect:!1,hostProduct:[],loadTitle:"加载更多",loading:!1,loadend:!1,visitList:[],limit:21,page:1,isAuto:!1,isShowAuth:!1,hotScroll:!1,hotPage:1,hotLimit:10,isItemAll:[]}},computed:(0,s.mapGetters)(["isLogin"]),onLoad:function(){this.isLogin?(this.loadend=!1,this.page=1,this.visitList=[],this.get_user_visit_list(),this.get_host_product()):(0,o.toLogin)()},onShow:function(){this.times=[],this.loadend=!1,this.page=1,this.visitList=[],this.get_user_visit_list()},methods:{goDetails:function(i){if(this.isShowChecked||!i.is_show)return!1;t.navigateTo({url:"/pages/goods_details/index?id="+i.product_id})},switchTap:function(){this.isShowChecked=!this.isShowChecked},collect:function(){var t=this,i=[];if(this.visitList.forEach((function(t){t.picList.forEach((function(t){t.checked&&i.push(t.product_id)}))})),!i.length)return this.$util.Tips({title:"请选择收藏商品"});(0,n.collectAdd)(i).then((function(i){return t.$util.Tips({title:i.msg})}))},del:function(){var t=this,i=[];if(this.visitList.forEach((function(t){t.picList.forEach((function(t){t.checked&&i.push(t.product_id)}))})),!i.length)return this.$util.Tips({title:"请选择删除商品"});(0,n.deleteVisitList)({ids:i}).then((function(i){return t.times=[],t.loadend=!1,t.page=1,t.$set(t,"visitList",[]),t.get_user_visit_list(),t.$util.Tips({title:i.msg})}))},picCheckbox:function(t,i){var e=this,n=t.detail.value;e.visitList[i].picList.forEach((function(t){-1!==n.indexOf(t.id+"")?t.checked=!0:t.checked=!1})),e.visitList[i].picList.length==n.length?e.visitList[i].checked=!0:e.visitList[i].checked=!1;var s=[];e.visitList.forEach((function(t){t.checked?s.push(t.time):-1!==s.indexOf(t.time)&&s.remove(t.time)})),s.length==e.visitList.length?e.isAllSelect=!0:e.isAllSelect=!1},checkboxChange:function(t){var i=this,e=t.detail.value;i.isItemAll=e,i.visitList.forEach((function(t,i){-1!==e.indexOf(t.time)?t.checked=!0:t.checked=!1,t.picList.forEach((function(i){t.checked?i.checked=!0:i.checked=!1}))})),e.length===i.visitList.length?i.isAllSelect=!0:i.isAllSelect=!1},forGoods:function(t){var i=this;i.visitList.length&&i.visitList.forEach((function(i){i.checked=!!t,i.picList.forEach((function(i){i.checked=!!t}))}))},checkboxAllChange:function(t){var i=t.detail.value;i.length?(this.isAllSelect=!0,this.forGoods(1)):(this.isAllSelect=!1,this.forGoods(0))},authColse:function(t){this.isShowAuth=t},get_user_visit_list:function(){var t=this,i=this;this.loading||this.loadend||(i.loading=!0,i.loadTitle="",(0,n.getVisitList)({page:i.page,limit:i.limit}).then((function(e){t.count=e.data.count;for(var n=0;n<e.data.time.length;n++)-1==t.times.indexOf(e.data.time[n])&&(t.times.push(e.data.time[n]),t.visitList.push({time:e.data.time[n],picList:[]}));for(var s=0;s<t.times.length;s++){t.visitList[s].checked=!!t.isAllSelect;for(var o=0;o<e.data.list.length;o++)t.times[s]===e.data.list[o].time_key&&(t.isAllSelect?e.data.list[o].checked=!0:e.data.list[o].checked=!1,t.visitList[s].picList.push(e.data.list[o]))}var c=e.data.list.length<i.limit;i.loadend=c,i.loadTitle=c?"没有更多内容啦~":"加载更多",i.page=i.page+1,i.loading=!1})).catch((function(t){i.loading=!1,i.loadTitle="加载更多"})))},get_host_product:function(){var t=this;t.hotScroll||(0,n.getProductHot)(t.hotPage,t.hotLimit).then((function(i){t.hotPage++,t.hotScroll=i.data.length<t.hotLimit,t.hostProduct=t.hostProduct.concat(i.data)}))}},onReachBottom:function(){this.visitList.length?this.get_user_visit_list():this.get_host_product()}};i.default=r}).call(this,e("543d")["default"])},db87:function(t,i,e){"use strict";e.r(i);var n=e("ac80"),s=e.n(n);for(var o in n)"default"!==o&&function(t){e.d(i,t,(function(){return n[t]}))}(o);i["default"]=s.a}},[["6da1","common/runtime","common/vendor"]]]);